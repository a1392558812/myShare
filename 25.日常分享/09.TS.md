## é«˜çº§ç±»å‹

### äº¤å‰ç±»å‹

> äº¤å‰ç±»å‹æ˜¯å°†å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹è¿™è®©æˆ‘ä»¬å¯ä»¥æŠŠç°æœ‰çš„å¤šç§ç±»å‹å åŠ åˆ°ä¸€èµ·æˆä¸ºä¸€ç§ç±»å‹ï¼Œå®ƒåŒ…å«äº†æ‰€éœ€çš„æ‰€æœ‰ç±»å‹çš„ç‰¹æ€§
>
> ä¸¾ä¸ªğŸŒ°ï¼šPerson & Serializable & Loggable`åŒæ—¶æ˜¯`Person`ä¸`Serializable`ä¸`Loggableç±»å‹çš„æ€»å’Œ
>
> ç‰¹ç‚¹ï¼š**åŒæ—¶æ‹¥æœ‰ç±»å‹A+B+C...æ‰€æœ‰çš„ç±»å‹**

```ts
function extend<T, U>(first: T, second: U): T & U { // ä¾‹å¦‚æ‹¼æ¥ä¸¤ä¸ªå¯¹è±¡
    let result = <T & U>{};
    for (let id in first) {
        (<any>result)[id] = (<any>first)[id];
    }
    for (let id in second) {
        if (!result.hasOwnProperty(id)) {
            (<any>result)[id] = (<any>second)[id];
        }
    }
    return result;
}

class Person {
    /*
    constructor(public name: string) {}ä¸ºç®€å†™
    å…·ä½“çš„ä¸º
        abstract class Department {
            public name: string;
            constructor(name: string) {
                this.name = name
            }
        }
    emmmmmmmmmmğŸ‘´éƒ½æœ‰ç‚¹å¿˜äº†emmmmmmmCï¼ˆ Â°â–³ Â°ï¼‰C
    */
    constructor(public name: string) { }
}
interface Loggable {
    log(): void;
}
class ConsoleLogger implements Loggable {
    log() {
        // ...
    }
}
var jim = extend(new Person("Jim"), new ConsoleLogger());
var n = jim.name;
jim.log()
```

### è”åˆç±»å‹

> è”åˆç±»å‹ä¸äº¤å‰ç±»å‹å¾ˆæœ‰å…³è”ï¼Œä½†æ˜¯ä½¿ç”¨ä¸Šå´å®Œå…¨ä¸åŒã€‚å¦‚æœä¸€ä¸ªå€¼æ˜¯è”åˆç±»å‹ï¼Œæˆ‘ä»¬åªèƒ½è®¿é—®æ­¤è”åˆç±»å‹çš„æ‰€æœ‰ç±»å‹é‡Œå…±æœ‰çš„æˆå‘˜ã€‚
>
> ç‰¹ç‚¹ï¼š**åªæ‹¥æœ‰ç±»å‹Aæˆ–è€…Bæˆ–è€…C...ä¸­æŸä¸€ä¸ªç±»å‹å’Œä»–ä»¬å…±åŒæˆå‘˜**

```ts
function padLeft(value: string, padding: string | number) {
    // ...
}

let indentedString = padLeft("Hello world", true); // errors during compilation
```

### ç±»å‹ä¿æŠ¤ä¸åŒºåˆ†ç±»å‹

> è”åˆç±»å‹é€‚åˆäºé‚£äº›å€¼å¯ä»¥ä¸ºä¸åŒç±»å‹çš„æƒ…å†µã€‚ 
>
> å¦‚ä»¥ä¸‹ä»£ç ï¼Œå½“æˆ‘ä»¬æƒ³ç¡®åˆ‡åœ°äº†è§£æ˜¯å¦ä¸º Fishæ—¶æ€ä¹ˆåŠï¼Ÿ 

```ts
interface Bird {
    fly();
    layEggs();
}
interface Fish {
    swim();
    layEggs();
}
function getSmallPet(): Fish | Bird { // æ­¤æ—¶åªèƒ½ä½¿ç”¨è¿”å›å€¼çš„layEggsæ–¹æ³•
    // ...
}
```

```ts
let pet = getSmallPet();
// æ¯ä¸€ä¸ªæˆå‘˜è®¿é—®éƒ½ä¼šæŠ¥é”™
if (pet.swim) {
    pet.swim();
}
else if (pet.fly) {
    pet.fly();
}
```

> JavaScripté‡Œå¸¸ç”¨æ¥åŒºåˆ†2ä¸ªå¯èƒ½å€¼çš„æ–¹æ³•æ˜¯æ£€æŸ¥æˆå‘˜æ˜¯å¦å­˜åœ¨ã€‚
>
> ä½†åœ¨TSé‡Œï¼Œæˆ‘ä»¬åªèƒ½è®¿é—®è”åˆç±»å‹ä¸­å…±åŒæ‹¥æœ‰çš„æˆå‘˜ã€‚
>
> é‚£å¦‚ä½•åˆ¤æ–­

**ä¸ºäº†è®©è¿™æ®µä»£ç å·¥ä½œï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ç±»å‹æ–­è¨€ï¼š**

```tex
let pet = getSmallPet();
if ((<Fish>pet).swim) {
    (<Fish>pet).swim();
} else {
    (<Bird>pet).fly();
}
```

### ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å‹ä¿æŠ¤

> TypeScripté‡Œçš„ *ç±»å‹ä¿æŠ¤*æœºåˆ¶è®©å®ƒæˆä¸ºäº†ç°å®ã€‚ ç±»å‹ä¿æŠ¤å°±æ˜¯ä¸€äº›è¡¨è¾¾å¼ï¼Œå®ƒä»¬ä¼šåœ¨è¿è¡Œæ—¶æ£€æŸ¥ä»¥ç¡®ä¿åœ¨æŸä¸ªä½œç”¨åŸŸé‡Œçš„ç±»å‹ã€‚ è¦å®šä¹‰ä¸€ä¸ªç±»å‹ä¿æŠ¤ï¼Œæˆ‘ä»¬åªè¦ç®€å•åœ°å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ª *ç±»å‹è°“è¯*ï¼š

```ts
function isFish(pet: Fish | Bird): pet is Fish {
    return (<Fish>pet).swim !== undefined;
}
```

**åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ`pet is Fish`å°±æ˜¯ç±»å‹è°“è¯ã€‚ è°“è¯ä¸º `parameterName is Type`è¿™ç§å½¢å¼ï¼Œ `parameterName`å¿…é¡»æ˜¯æ¥è‡ªäºå½“å‰å‡½æ•°ç­¾åé‡Œçš„ä¸€ä¸ªå‚æ•°åã€‚**

**æ¯å½“ä½¿ç”¨ä¸€äº›å˜é‡è°ƒç”¨ `isFish`æ—¶ï¼ŒTypeScriptä¼šå°†å˜é‡ç¼©å‡ä¸ºé‚£ä¸ªå…·ä½“çš„ç±»å‹ï¼Œåªè¦è¿™ä¸ªç±»å‹ä¸å˜é‡çš„åŸå§‹ç±»å‹æ˜¯å…¼å®¹çš„ã€‚**

```ts
// 'swim' å’Œ 'fly' è°ƒç”¨éƒ½æ²¡æœ‰é—®é¢˜äº†

if (isFish(pet)) {
    pet.swim();
}
else {
    pet.fly();
}
```

> ç®€å•ç†è§£â€œparameterName is Typeâ€åšäº†å•¥

```ts
interface Bird {
    fly();
    layEggs();
}
interface Fish {
    swim();
    layEggs();
}
function getSmallPet(): Fish | Bird {  // ...  }
// pet is FishæŒ‡å®šå‚æ•°petçš„ç±»å‹å°±ä¸ºFishç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºâ€œpetæ˜¯Fishç±»å‹ä¹ˆï¼Ÿâ€
// emmmmmmmméƒ½ç–‘é—®å¥äº†ï¼Œè¿”å›å€¼æ˜¯boolean
function isFish(pet: Fish | Bird): pet is Fish { 
    // å‡è®¾è¿è¡Œè¿‡ç¨‹ä¸­petçš„ç±»å‹å°±æ˜¯æˆ‘ä»¬æŒ‡å®šçš„ç±»å‹ï¼šFishç±»å‹ï¼Œ
    // é‚£ä¹ˆä»–å¿…ç„¶æœ‰swimæ–¹æ³•
    return (<Fish>pet).swim !== undefined;
}
// æ³¨æ„TypeScriptä¸ä»…çŸ¥é“åœ¨ ifåˆ†æ”¯é‡Œ petæ˜¯ Fishç±»å‹ï¼› å®ƒè¿˜æ¸…æ¥šåœ¨ elseåˆ†æ”¯é‡Œï¼Œä¸€å®š ä¸æ˜¯ Fishç±»å‹
if (isFish(pet)) {
    pet.swim();
}
else {
    pet.fly();
}
```

### `typeof`ç±»å‹ä¿æŠ¤

```ts
function isNumber(x: any): x is number {
    return typeof x === "number";
}

function isString(x: any): x is string {
    return typeof x === "string";
}

function padLeft(value: string, padding: string | number) {
    if (isNumber(padding)) {
        return Array(padding + 1).join(" ") + value;
    }
    if (isString(padding)) {
        return padding + value;
    }
    throw new Error(`Expected string or number, got '${padding}'.`);
}
```

> æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ä»£ç é‡Œæ£€æŸ¥ç±»å‹ï¼Œä»¥ä¸‹ä»£ç ä¹Ÿç”Ÿæ•ˆ

```ts
function padLeft(value: string, padding: string | number) {
    if (typeof padding === "number") {
        return Array(padding + 1).join(" ") + value;
    }
    if (typeof padding === "string") {
        return padding + value;
    }
    throw new Error(`Expected string or number, got '${padding}'.`);
}
```

**è¿™äº›`typeof`ç±»å‹ä¿æŠ¤åªæœ‰ä¸¤ç§å½¢å¼èƒ½è¢«è¯†åˆ«ï¼š **

* **`typeof v === "typename"`ä¸`typeof v !== "typename"`**

	* `"typename"`å¿…é¡»æ˜¯ `"number"`ï¼Œ `"string"`ï¼Œ `"boolean"`æˆ– `"symbol"`ã€‚

	* TypeScriptå¹¶ä¸ä¼šé˜»æ­¢ä½ ä¸å…¶å®ƒå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œè¯­è¨€ä¸ä¼šæŠŠé‚£äº›è¡¨è¾¾å¼è¯†åˆ«ä¸ºç±»å‹ä¿æŠ¤ã€‚

### `instanceof`ç±»å‹ä¿æŠ¤

> `instanceof` è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ `prototype` å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚

```ts
interface Padder {
    getPaddingString(): string
}
class SpaceRepeatingPadder implements Padder {
    constructor(private numSpaces: number) { }
    getPaddingString() {
        return Array(this.numSpaces + 1).join("ğŸ‘´");
    }
}
class StringPadder implements Padder {
    constructor(private value: string) { }
    getPaddingString() {
        return this.value;
    }
}
function getRandomPadder() {
    return Math.random() < 0.5 ?
        new SpaceRepeatingPadder(4) :
        new StringPadder("  ");
}

// ç±»å‹ä¸ºSpaceRepeatingPadder | StringPadder
let padder: Padder = getRandomPadder();

if (padder instanceof SpaceRepeatingPadder) {
    padder; // ç±»å‹ç»†åŒ–ä¸º'SpaceRepeatingPadder'
}
if (padder instanceof StringPadder) {
    padder; // ç±»å‹ç»†åŒ–ä¸º'StringPadder'
}
```

> å¦‚æœç¼–è¯‘å™¨ä¸èƒ½å¤Ÿå»é™¤ `null`æˆ– `undefined`ï¼Œä½ å¯ä»¥ä½¿ç”¨ç±»å‹æ–­è¨€æ‰‹åŠ¨å»é™¤ã€‚ 
>
> è¯­æ³•æ˜¯æ·»åŠ  `!`åç¼€ï¼Œ
>
> å¦‚ä»¥ä¸‹ä»£ç  `name!`ä» `name`çš„ç±»å‹é‡Œå»é™¤äº† `null`å’Œ `undefined`ï¼š

```ts
function broken(name: string | null): string {
  function postfix(epithet: string) {
    return name.charAt(0) + '.  the ' + epithet; // error, 'name' is possibly null
  }
  name = name || "Bob";
  return postfix("great");
}
function fixed(name: string | null): string {
  function postfix(epithet: string) {
    return name!.charAt(0) + '.  the ' + epithet; // ok
  }
  name = name || "Bob";
  return postfix("great");
}
```

### ç±»å‹åˆ«å

> ç±»å‹åˆ«åä¼šç»™ä¸€ä¸ªç±»å‹èµ·ä¸ªæ–°åå­—ã€‚ ç±»å‹åˆ«åæœ‰æ—¶å’Œæ¥å£å¾ˆåƒï¼Œä½†æ˜¯å¯ä»¥ä½œç”¨äºåŸå§‹å€¼ï¼Œè”åˆç±»å‹ï¼Œå…ƒç»„ä»¥åŠå…¶å®ƒä»»ä½•ä½ éœ€è¦æ‰‹å†™çš„ç±»å‹ã€‚

```ts
type Name = string;
type NameResolver = () => string;
type NameOrResolver = Name | NameResolver;
function getName(n: NameOrResolver): Name {
    if (typeof n === 'string') {
        return n;
    }
    else {
        return n();
    }
}
// ç±»å‹åˆ«åå¯ä»¥ä½¿ç”¨æ³›å‹
type MyType<T> = {x:T,y:T};
let value1:MyType<number>;
value1 = {x:111,y:2123};
value1 = {x:'21232',y:1234}; // ä¸èƒ½å°†ç±»å‹â€œstringâ€åˆ†é…ç»™ç±»å‹â€œnumberâ€ã€‚ts(2322)
```

> åŒæ¥å£ä¸€æ ·ï¼Œç±»å‹åˆ«åä¹Ÿå¯ä»¥æ˜¯æ³›å‹ - æˆ‘ä»¬å¯ä»¥æ·»åŠ ç±»å‹å‚æ•°å¹¶ä¸”åœ¨åˆ«åå£°æ˜çš„å³ä¾§ä¼ å…¥ï¼š

```ts
type Container<T> = { value: T };
type router<T> = {
    router: T;
    childRouter: router<T> | undefined;
    meta: {
        keepAlive?: boolean,
        param?:string
    };
}
// emmmmmmmmè¿™ç§å¯¹è±¡æ ¼å¼æ„Ÿè§‰åŸºæœ¬ä¸Šä¸ç”¨ğŸ˜…ğŸ˜…ğŸ˜…ğŸ˜…
let obj:router<string> = {
    router:'ğŸ”',
    childRouter:{
        router:'ä¿©ğŸ”',
        childRouter:undefined,
        meta:{},
    },
    meta:{
        keepAlive:true,
        param:'å¥¥åˆ©ç»™ï¼Œå¹²äº†å…„å¼Ÿä»¬',
    }
}
```

### å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹

> å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹å…è®¸ä½ æŒ‡å®šå­—ç¬¦ä¸²å¿…é¡»çš„å›ºå®šå€¼ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå­—ç¬¦ä¸²å­—é¢é‡ç±»å‹å¯ä»¥ä¸è”åˆç±»å‹ï¼Œç±»å‹ä¿æŠ¤å’Œç±»å‹åˆ«åå¾ˆå¥½çš„é…åˆã€‚ é€šè¿‡ç»“åˆä½¿ç”¨è¿™äº›ç‰¹æ€§ï¼Œä½ å¯ä»¥å®ç°ç±»ä¼¼æšä¸¾ç±»å‹çš„å­—ç¬¦ä¸²ã€‚

```ts
type Easing = "ease-in" | "ease-out" | "ease-in-out";
class UIElement {
    animate(dx: number, dy: number, easing: Easing) {
        if (easing === "ease-in") {
            // ...
        }
        else if (easing === "ease-out") {
        }
        else if (easing === "ease-in-out") {
        }
        else {
            // error! should not pass null or undefined.
        }
    }
}

let button = new UIElement();
button.animate(0, 0, "ease-in");
button.animate(0, 0, "uneasy"); // error: "uneasy" is not allowed here
// ä½ åªèƒ½ä»ä¸‰ç§å…è®¸çš„å­—ç¬¦ä¸­é€‰æ‹©å…¶ä¸€æ¥åšä¸ºå‚æ•°ä¼ é€’ï¼Œä¼ å…¥å…¶å®ƒå€¼åˆ™ä¼šäº§ç”Ÿé”™è¯¯ã€‚
```

### å¯è¾¨è¯†è”åˆ

> åˆå¹¶å•ä¾‹ç±»å‹ï¼Œè”åˆç±»å‹ï¼Œç±»å‹ä¿æŠ¤å’Œç±»å‹åˆ«åæ¥åˆ›å»ºä¸€ä¸ªå«åš *å¯è¾¨è¯†è”åˆ*çš„é«˜çº§æ¨¡å¼ï¼Œå®ƒä¹Ÿç§°åš *æ ‡ç­¾è”åˆ*æˆ– *ä»£æ•°æ•°æ®ç±»å‹*
>
>  å®ƒå…·æœ‰3ä¸ªè¦ç´ ï¼š
>
> 1. å…·æœ‰æ™®é€šçš„å•ä¾‹ç±»å‹å±æ€§â€” *å¯è¾¨è¯†çš„ç‰¹å¾*ã€‚
> 2. ä¸€ä¸ªç±»å‹åˆ«ååŒ…å«äº†é‚£äº›ç±»å‹çš„è”åˆâ€” *è”åˆ*ã€‚
> 3. æ­¤å±æ€§ä¸Šçš„ç±»å‹ä¿æŠ¤ã€‚

```ts
interface Square {
    kind: "square";
    size: number;
}
interface Rectangle {
    kind: "rectangle";
    width: number;
    height: number;
}
interface Circle {
    kind: "circle";
    radius: number;
}
```

é¦–å…ˆæˆ‘ä»¬å£°æ˜äº†å°†è¦è”åˆçš„æ¥å£ã€‚ æ¯ä¸ªæ¥å£éƒ½æœ‰ `kind`å±æ€§ä½†æœ‰ä¸åŒçš„å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹ã€‚ `kind`å±æ€§ç§°åš *å¯è¾¨è¯†çš„ç‰¹å¾*æˆ– *æ ‡ç­¾*ã€‚ å…¶å®ƒçš„å±æ€§åˆ™ç‰¹å®šäºå„ä¸ªæ¥å£ã€‚ æ³¨æ„ï¼Œç›®å‰å„ä¸ªæ¥å£é—´æ˜¯æ²¡æœ‰è”ç³»çš„ã€‚ ä¸‹é¢æˆ‘ä»¬æŠŠå®ƒä»¬è”åˆåˆ°ä¸€èµ·ï¼š

```ts
type Shape = Square | Rectangle | Circle;
```

```ts
function area(s: Shape) {
    switch (s.kind) {
        case "square": return s.size * s.size;
        case "rectangle": return s.height * s.width;
        case "circle": return Math.PI * s.radius ** 2;
    }
}
```

* å®Œæ•´æ€§æ£€æŸ¥

å½“æ²¡æœ‰æ¶µç›–æ‰€æœ‰å¯è¾¨è¯†è”åˆçš„å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬æƒ³è®©ç¼–è¯‘å™¨å¯ä»¥é€šçŸ¥æˆ‘ä»¬ã€‚ æ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ·»åŠ äº† `Triangle`åˆ° `Shape`ï¼Œæˆ‘ä»¬åŒæ—¶è¿˜éœ€è¦æ›´æ–° `area`:

```ts
type Shape = Square | Rectangle | Circle | Triangle;
function area(s: Shape) {
    switch (s.kind) {
        case "square": return s.size * s.size;
        case "rectangle": return s.height * s.width;
        case "circle": return Math.PI * s.radius ** 2;
    }
    //æƒ³è®©ç¼–è¾‘å™¨æç¤ºæˆ‘ä»¬ï¼ŒTriangleè¿˜æ²¡ä¸Šè½¦å‘¢ğŸš•ï¼Œåº”è¯¥case â€˜Triangleâ€™
}
```

æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å®ç°

 1. é¦–å…ˆæ˜¯å¯ç”¨ `--strictNullChecks`ï¼ˆç©ºæŒ‡é’ˆæ£€æŸ¥ï¼‰å¹¶ä¸”æŒ‡å®šä¸€ä¸ªè¿”å›å€¼ç±»å‹

    ```ts
    function area(s: Shape): number { // error: returns number | undefined
        switch (s.kind) {
            case "square": return s.size * s.size;
            case "rectangle": return s.height * s.width;
            case "circle": return Math.PI * s.radius ** 2;
        }
    }
    // å› ä¸º switchæ²¡æœ‰åŒ…æ¶µæ‰€æœ‰æƒ…å†µï¼Œæ‰€ä»¥TypeScriptè®¤ä¸ºè¿™ä¸ªå‡½æ•°æœ‰æ—¶å€™ä¼šè¿”å› undefinedã€‚
    // å¦‚æœä½ æ˜ç¡®åœ°æŒ‡å®šäº†è¿”å›å€¼ç±»å‹ä¸º numberï¼Œé‚£ä¹ˆä½ ä¼šçœ‹åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œ
    // å› ä¸ºå®é™…ä¸Šè¿”å›å€¼çš„ç±»å‹ä¸º number | undefined
    ```

 2. ç¬¬äºŒç§æ–¹æ³•ä½¿ç”¨ `never`ç±»å‹ï¼Œç¼–è¯‘å™¨ç”¨å®ƒæ¥è¿›è¡Œå®Œæ•´æ€§æ£€æŸ¥ï¼š

    ```ts
    interface Square {
        kind: "square";
        size: number;
    }
    interface Rectangle {
        kind: "rectangle";
        width: number;
        height: number;
    }
    interface Circle {
        kind: "circle";
        radius: number;
    }
    interface Triangle {
        kind: "Triangle";
        SideLength1: number;
        SideLength2: number;
        SideLength3: number;
    }
    type Shape = Square | Rectangle | Circle | Triangle;
    function assertNever(x: never): never {
        throw new Error("æˆ‘è¿˜æ²¡ä¸Šè½¦å‘¢ğŸš–ğŸš–ğŸš–ğŸš–: " + x);
    }
    function area(s: Shape) {
        switch (s.kind) {
            case "square": return s.size * s.size;
            case "rectangle": return s.height * s.width;
            case "circle": return Math.PI * s.radius ** 2;
            default: return assertNever(s); // error here if there are missing cases
        }
    }
    ```

### ç´¢å¼•ç±»å‹

> emmmmmmğŸ‘†ä»£ç ğŸ´

```ts
function pluck<T, K extends keyof T>(o: T, names: K[]): T[K][] {
  return names.map(n => o[n]);
}
interface Person {
    name: string;
    age: number;
}
let person: Person = {
    name: 'Jarid',
    age: 35
};
let strings: string[] = pluck(person, ['name']);
```

> ????????????ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³

> åšäº†ä»€ä¹ˆï¼Ÿæå‡ºé—®é¢˜ï¼Œå…ˆæš‚æ—¶è·³å‡ºæ‡µé€¼ï¼Œçœ‹ä»¥ä¸‹ä»£ğŸ´
>
> ```ts
> const a = {
>  a: 1,
>  b: 2,
> };
> keyof typeof a; // 'a' | 'b'
> 
> class A {
>  c: number;
>  d: number;
> }
> 
> keyof A; // 'c' | 'd'
> let personProps: keyof Person; // 'name' | 'age'
> ```
>
> **keyof Tçš„ç»“æœä¸ºTä¸Šå·²çŸ¥çš„å…¬å…±å±æ€§åçš„è”åˆ**
>
> **ç¼–è¯‘å™¨ä¼šæ£€æŸ¥ `name`æ˜¯å¦çœŸçš„æ˜¯ `Person`çš„ä¸€ä¸ªå±æ€§**
>
> 1. `<T, K extends keyof T>`æ˜¯å•¥
>
>    1. æ¥æ”¶ç±»å‹å‚æ•°Tä¸Kï¼Œ å¯¹äºä»»ä½•ç±»å‹ `T`ï¼Œ `keyof T`çš„ç»“æœä¸º `T`ä¸Šå·²çŸ¥çš„ <font color=#ff0000>**å…¬å…±å±æ€§å**</font>çš„è”åˆ
>
>     2. `keyof Person`æ˜¯å®Œå…¨å¯ä»¥ä¸ `'name' | 'age'`äº’ç›¸æ›¿æ¢çš„,ä¸åŒçš„æ˜¯å¦‚æœä½ æ·»åŠ äº†å…¶å®ƒçš„å±æ€§åˆ° `Person`ï¼Œä¾‹å¦‚ `address: string`ï¼Œé‚£ä¹ˆ `keyof Person`ä¼šè‡ªåŠ¨å˜ä¸º `'name' | 'age' | 'address'`
>
>     3. ç²—æš´ç†è§£ï¼ŒKå°±æ˜¯å‚æ•°oçš„keyï¼Œå®é™…æ•ˆæœç±»ä¼¼äºObject.keys()ã€‚`keyof` å¯ä»¥ç”¨æ¥å–å¾—ä¸€ä¸ªå¯¹è±¡æ¥å£çš„æ‰€æœ‰ `key` å€¼.
>
>     4.  ä½ å¯ä»¥åœ¨åƒ `pluck`å‡½æ•°è¿™ç±»ä¸Šä¸‹æ–‡é‡Œä½¿ç”¨ `keyof`ï¼Œå› ä¸ºåœ¨ä½¿ç”¨ä¹‹å‰ä½ å¹¶ä¸æ¸…æ¥šå¯èƒ½å‡ºç°çš„å±æ€§åã€‚ ä½†ç¼–è¯‘å™¨ä¼šæ£€æŸ¥ä½ æ˜¯å¦ä¼ å…¥äº†æ­£ç¡®çš„å±æ€§åç»™ `pluck`
>
>        ```ts
>        pluck(person, ['age', 'unknown']); // error, 'unknown' is not in 'name' | 'age'
>        ```
>
> 2. `o: T, names: K[]`æ˜¯å•¥
>
>    â€‹	æ¥å—å‚æ•°o,æ•æ‰oçš„æ•°æ®ç±»å‹,æ¥å—æ•°ç»„namesï¼Œæ•°ç»„é‡Œæ¯ä¸€é¡¹çš„ç±»å‹ä¸ºKï¼Œ
>
> 3. `T[K][]`æ˜¯å•¥
>
>    emmmmmmmï¼Œé¦–å…ˆå¯ä»¥æ˜ç¡®è¿”å›äº†ä¸ªæ•°ç»„ï¼Œä½†T[K]ï¼Œï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼ŸğŸ´çš„ï¼Œ
>    
>    `T[K]`ï¼Œ **ç´¢å¼•è®¿é—®æ“ä½œç¬¦**ã€‚ è¿™æ„å‘³ç€ `person['name']`å…·æœ‰ç±»å‹ `Person['name']` ï¼Œé‚£åœ¨ä¸Šé¢ä¾‹å­ğŸŒ°ä¸­å°±æ˜¯string

```ts
function getProperty<T, K extends keyof T>(o: T, name: K): T[K] {
    return o[name]; // o[name] is of type T[K]
}
```

> `getProperty`é‡Œçš„ `o: T`å’Œ `name: K`ï¼Œæ„å‘³ç€ `o[name]: T[K]`ã€‚
>
>  å½“ä½ è¿”å› `T[K]`çš„ç»“æœï¼Œç¼–è¯‘å™¨ä¼šå®ä¾‹åŒ–é”®çš„çœŸå®ç±»å‹ï¼Œå› æ­¤ `getProperty`çš„è¿”å›å€¼ç±»å‹ä¼šéšç€ä½ éœ€è¦çš„å±æ€§æ”¹å˜ã€‚

```ts
let name: string = getProperty(person, 'name');
let age: number = getProperty(person, 'age');
let unknown = getProperty(person, 'unknown'); // error, 'unknown' is not in 'name' | 'age'
```

### ç´¢å¼•ç±»å‹å’Œå­—ç¬¦ä¸²ç´¢å¼•ç­¾å

> `keyof`å’Œ `T[K]`ä¸å­—ç¬¦ä¸²ç´¢å¼•ç­¾åè¿›è¡Œäº¤äº’ã€‚ å¦‚æœä½ æœ‰ä¸€ä¸ªå¸¦æœ‰å­—ç¬¦ä¸²ç´¢å¼•ç­¾åçš„ç±»å‹ï¼Œé‚£ä¹ˆ `keyof T`ä¼šæ˜¯ `string`ã€‚ å¹¶ä¸” `T[string]`ä¸ºç´¢å¼•ç­¾åçš„ç±»å‹ï¼š
>
> emmmmmmmmm

```ts
interface Map<T> {
    [key: string]: T;
}
let keys: keyof Map<number>; // string
let value: Map<number>['foo']; // number
```

### æ˜ å°„ç±»å‹

```ts
interface PersonPartial {
    name?: string;
    age?: number;
}
interface PersonReadonly {
    readonly name: string;
    readonly age: number;
}
```

> éœ€æ±‚ï¼šreadonlyæ˜¯å¯é€‰çš„ï¼Œ![img](./image/haha.png)
>
> æ‡µäº†
>
> å…ˆçœ‹ä»£ç 
>
> ```ts
> type Readonly<T> = { // ä½œç”¨æ˜¯å°†ä¼ å…¥çš„å±æ€§å˜ä¸ºåªè¯»é¡¹.
> readonly [P in keyof T]: T[P];
> }
> type Partial<T> = { // ä½œç”¨æ˜¯å°†ä¼ å…¥çš„å±æ€§å˜ä¸ºå¯é€‰é¡¹.
> [P in keyof T]?: T[P];
> }
> type PersonPartial = Partial<Person>;
> type ReadonlyPerson = Readonly<Person>;
> ```
>
> ????????????`[P in keyof T]`??????????????/
>
> 1. keyof Tå¾ˆç†Ÿæ‚‰äº†ï¼Œå³å–å¾—ä¸€ä¸ªå¯¹è±¡æ¥å£Tçš„æ‰€æœ‰ `key` å€¼.
>
>    ```ts
>    interface Foo {
>      name: string;
>      age: number
>    }
>    type T = keyof Foo // -> "name" | "age"
>    ```
>
> 2.  inå¯ä»¥éå†æšä¸¾ç±»å‹, ä¾‹å¦‚
>
>    ```ts
>    type Keys = "a" | "b"
>    type Obj =  {
>      [p in Keys]: any
>    } // -> { a: any, b: any }
>    ```
>
> ä¸Šè¿°ä¾‹å­ğŸŒ°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å½’çº³ä¸º
>
> **`keyof` äº§ç”Ÿè”åˆç±»å‹, `in` åˆ™å¯ä»¥éå†æšä¸¾ç±»å‹**
>
> é‚£ä¹ˆ`type Partial<T> = { [P in keyof T]?: T[P] };` çš„æ„æ€ï¼Œå°±æ˜¯`keyof T` æ‹¿åˆ° T æ‰€æœ‰å±æ€§å, ç„¶å `in` è¿›è¡Œéå†, å°†å€¼èµ‹ç»™ P, æœ€å `T[P]` å–å¾—ç›¸åº”å±æ€§çš„å€¼.
>
> é‚£........æ¥ä¸ªå°æ€»ç»“??
>
> ## Required
>
> Required çš„ä½œç”¨æ˜¯å°†ä¼ å…¥çš„å±æ€§å˜ä¸ºå¿…é€‰é¡¹
>
> ```ts
> type Required<T> = { [P in keyof T]-?: T[P] };
> ```
> è¿™ä¸ª`-?`, è¿™é‡Œå¾ˆå¥½ç†è§£å°±æ˜¯å°†å¯é€‰é¡¹ä»£è¡¨çš„ ? å»æ‰, ä»è€Œè®©è¿™ä¸ªç±»å‹å˜æˆå¿…é€‰é¡¹. ä¸ä¹‹å¯¹åº”çš„è¿˜æœ‰ä¸ª+? , è¿™>ä¸ªå«ä¹‰è‡ªç„¶ä¸-?ä¹‹å‰ç›¸å, å®ƒæ˜¯ç”¨æ¥æŠŠå±æ€§å˜æˆå¯é€‰é¡¹çš„
>
> ## Mutable (æœªåŒ…å«)
>
> ç±»ä¼¼åœ°, å…¶å®è¿˜æœ‰å¯¹ `+` å’Œ `-`, è¿™é‡Œè¦è¯´çš„ä¸æ˜¯å˜é‡çš„ä¹‹é—´çš„è¿›è¡ŒåŠ å‡è€Œæ˜¯å¯¹ `readonly` è¿›è¡ŒåŠ å‡.
> ä»¥ä¸‹ä»£ç çš„ä½œç”¨å°±æ˜¯å°† T çš„æ‰€æœ‰å±æ€§çš„ readonly ç§»é™¤,
>
> ```ts
> type Mutable<T> = {
>   -readonly [P in keyof T]: T[P]
> }
> ```
>
> ## Readonly
>
> å°†ä¼ å…¥çš„å±æ€§å˜ä¸ºåªè¯»é€‰é¡¹
>
> ```ts
> type Readonly<T> = { readonly [P in keyof T]: T[P] };
> ```
>
> ## Record
>
> å°† K ä¸­æ‰€æœ‰çš„å±æ€§çš„å€¼è½¬åŒ–ä¸º T ç±»å‹
>
> ```ts
> type Record<K extends keyof any, T> = { [P in K]: T };
> ```
>
> ## Pick
>
> ä» T ä¸­å–å‡º ä¸€ç³»åˆ— K çš„å±æ€§
>
> ```ts
> type Pick<T, K extends keyof T> = { [P in K]: T[P] };
> ```
>
> emmmmmmmmmmmmm
>
> ```ts
> type Proxy<T> = {
>     get(): T;
>     set(value: T): void;
> }
> type Proxify<T> = {
>     [P in keyof T]: Proxy<T[P]>;
> }
> function proxify<T>(o: T): Proxify<T> {
>    // ... wrap proxies ...
> }
> let proxyProps = proxify(props);
> ```



<img src="./image\emmm.jpg" alt="heishou" style="zoom:67%;" />



> ### é¢„å®šä¹‰çš„æœ‰æ¡ä»¶ç±»å‹
>
> TypeScript 2.8åœ¨`lib.d.ts`é‡Œå¢åŠ äº†ä¸€äº›é¢„å®šä¹‰çš„æœ‰æ¡ä»¶ç±»å‹ï¼š
>
> - `Exclude<T, U>` -- ä»`T`ä¸­å‰”é™¤å¯ä»¥èµ‹å€¼ç»™`U`çš„ç±»å‹ã€‚
> - `Extract<T, U>` -- æå–`T`ä¸­å¯ä»¥èµ‹å€¼ç»™`U`çš„ç±»å‹ã€‚
> - `NonNullable<T>` -- ä»`T`ä¸­å‰”é™¤`null`å’Œ`undefined`ã€‚sss
> - `ReturnType<T>` -- è·å–å‡½æ•°è¿”å›å€¼ç±»å‹ã€‚
> - `InstanceType<T>` -- è·å–æ„é€ å‡½æ•°ç±»å‹çš„å®ä¾‹ç±»å‹ã€‚
>
> ```ts
> type T00 = Exclude<"a" | "b" | "c" | "d", "a" | "c" | "f">;  // "b" | "d"
> type T01 = Extract<"a" | "b" | "c" | "d", "a" | "c" | "f">;  // "a" | "c"
> 
> type T02 = Exclude<string | number | (() => void), Function>;  // string | number
> type T03 = Extract<string | number | (() => void), Function>;  // () => void
> 
> type T04 = NonNullable<string | number | undefined>;  // string | number
> type T05 = NonNullable<(() => string) | string[] | null | undefined>;  // (() => string) | string[]
> 
> function f1(s: string) {
>     return { a: 1, b: s };
> }
> 
> class C {
>     x = 0;
>     y = 0;
> }
> 
> type T10 = ReturnType<() => string>;  // string
> type T11 = ReturnType<(s: string) => void>;  // void
> type T12 = ReturnType<(<T>() => T)>;  // {}
> //<T extends U, U extends number[]>() => T
> type T13 = ReturnType<(<T extends U, U extends number[]>() => T)>;  // number[]
> type T14 = ReturnType<typeof f1>;  // { a: number, b: string }
> type T15 = ReturnType<any>;  // any
> type T16 = ReturnType<never>;  // any
> type T17 = ReturnType<string>;  // Error
> type T18 = ReturnType<Function>;  // Error
> 
> type T20 = InstanceType<typeof C>;  // C
> type T21 = InstanceType<any>;  // any
> type T22 = InstanceType<never>;  // any
> type T23 = InstanceType<string>;  // Error
> type T24 = InstanceType<Function>;  // Error
> ```
>


# vue 横向滚动 hook

```typescript
import { onMounted, onUnmounted, Ref, ref } from "vue";

/**
 * 鼠标滚轮横向滚动hooks
 * 当元素可横向滚动时，滚轮控制横向滚动；否则保持默认纵向滚动
 * @param targetRef 目标元素的 Ref
 * @param speed 滚动速度系数（默认 0.5，值越大滚动越快）
 * @returns 包含滚动状态的对象
 */
export const useWheelScroll = (
  targetRef: Ref<HTMLElement | null>,
  speed = 0.5
) => {
  const isScrolling = ref(false);

  const handleWheel = (e: WheelEvent) => {
    const target = targetRef.value;
    if (!target) return;

    const { scrollLeft, scrollWidth, clientWidth } = target;
    const maxScrollLeft = scrollWidth - clientWidth;
    const delta = e.deltaY;

    const canScrollRight = delta > 0 && scrollLeft < maxScrollLeft;
    const canScrollLeft = delta < 0 && scrollLeft > 0;

    if (maxScrollLeft > 0 && (canScrollRight || canScrollLeft)) {
      e.preventDefault();

      isScrolling.value = true;

      const scrollDistance = e.deltaY * speed;

      target.scrollBy({
        left: scrollDistance,
        behavior: "smooth",
      });

      // 滚动结束后重置状态（延迟 100ms 避免频繁切换）
      setTimeout(() => {
        isScrolling.value = false;
      }, 100);
    } else {
      isScrolling.value = false;
    }
  };

  onMounted(() => {
    const target = targetRef.value;
    if (target) {
      // 注意：passive 必须设为 false，否则无法通过 e.preventDefault() 阻止默认行为
      target.addEventListener("wheel", handleWheel, { passive: false });
    }
  });

  onUnmounted(() => {
    const target = targetRef.value;
    if (target) {
      target.removeEventListener("wheel", handleWheel);
    }
  });

  return {
    isScrolling,
  };
};
```

<vue3-sfc>
<vue3-file name="App.vue">
<template>
  <div class="container">
    <h3>横向滚动区域</h3>
    <!-- 横向滚动容器 -->
    <div ref="scrollContainer" class="horizontal-scroll">
      <!-- 滚动内容（宽度足够长以产生横向滚动） -->
      <div class="scroll-content">
        <div class="item">Item 1</div>
        <div class="item">Item 2</div>
        <div class="item">Item 3</div>
        <div class="item">Item 4</div>
        <div class="item">Item 5</div>
        <div class="item">Item 6</div>
        <div class="item">Item 7</div>
        <div class="item">Item 8</div>
      </div>
    </div>
    <div class="scroll-content2"></div>
    
    <!-- 显示滚动状态（可选） -->
    <p v-if="isScrolling" class="scroll-status">横向滚动中...</p>
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { useWheelScroll } from './useWheelScroll';

const scrollContainer = ref(null);

const { isScrolling } = useWheelScroll(scrollContainer, 1);
</script>

<style scoped>
.container {
  max-width: 800px;
  margin: 20px auto;
  padding: 0 20px;
}

.horizontal-scroll {
  width: 100%;
  overflow: auto;
  padding: 10px 0;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
}

.scroll-content {
  display: flex;
  gap: 16px;
  padding: 10px;
  width: max-content;
}

.scroll-content2 {
  height: 500px;
  width: 200vh;
  background: #aaf5f5;
}

.item {
  width: 200px;
  height: 120px;
  background: #f5f5f5;
  border: 1px solid #ddd;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
}

.scroll-status {
  color: #666;
  font-size: 14px;
  margin-top: 10px;
  text-align: center;
}
</style>
</vue3-file>

<vue3-file name="useWheelScroll.js">
import { onMounted, onUnmounted, ref } from "vue";
export const useWheelScroll = (targetRef, speed = 0.5) => {
  const isScrolling = ref(false);
  const handleWheel = (e) => {
    const target = targetRef.value;
    if (!target) return;
    const { scrollLeft, scrollWidth, clientWidth } = target;
    const maxScrollLeft = scrollWidth - clientWidth;
    const delta = e.deltaY;
    const canScrollRight = delta > 0 && scrollLeft < maxScrollLeft;
    const canScrollLeft = delta < 0 && scrollLeft > 0;
    if (maxScrollLeft > 0 && (canScrollRight || canScrollLeft)) {
      e.preventDefault();
      isScrolling.value = true;
      const scrollDistance = e.deltaY * speed;
      target.scrollBy({
        left: scrollDistance,
        behavior: "smooth",
      });
      // 滚动结束后重置状态（延迟 100ms 避免频繁切换）
      setTimeout(() => {
        isScrolling.value = false;
      }, 100);
    } else {
      isScrolling.value = false;
    }
  };
  onMounted(() => {
    const target = targetRef.value;
    if (target) {
      // 注意：passive 必须设为 false，否则无法通过 e.preventDefault() 阻止默认行为
      target.addEventListener("wheel", handleWheel, { passive: false });
    }
  });
  onUnmounted(() => {
    const target = targetRef.value;
    if (target) {
      target.removeEventListener("wheel", handleWheel);
    }
  });
  return {
    isScrolling,
  };
}
</vue3-file>
</vue3-sfc>

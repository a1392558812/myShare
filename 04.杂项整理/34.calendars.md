# calendars

> 组件没有任何功能，只有最基础的展示，方便拓展自定义的逻辑和样式

## 使用

```html
<template>
  <calendars :current-date="currentDate" :start-week="0">
    <template #weekItem="{ weekNum, weekLabel }">
      {{ weekNum }}/{{ weekLabel }}
    </template>
    <template #day="{ value, week, weekIndex }">
      <view class="flex flex-col items-center justify-center">
        <view :week="week" :week-index="weekIndex"> {{ value.day }}号</view>
        <view>{{ targetDay(value) }}</view>
      </view>
    </template>
  </calendars>
  <view class="flex">
    <button
      @click="currentDate = dayjs(currentDate).add(1, 'month').format('YYYY-MM-DD')"
    >
      +1月
    </button>
    <button
      @click="currentDate = dayjs(currentDate).subtract(1, 'month').format('YYYY-MM-DD')"
    >
      -1月
    </button>
  </view>
</template>
<script setup lang="ts">
  import CALENDAR from "https://github.com/jjonline/calendar.js";
  import dayjs from "https://github.com/iamkun/dayjs";

  const currentDate = ref(dayjs().format("YYYY-MM-DD"));
  const targetDay = computed(
    () =>
      (item: {
        year: number;
        month: number;
        day: number;
        date: string;
        canClick: boolean; // 是否是本月日期
        weekDay: number; // 星期x 星期一:1 星期二:2 星期日:0
      }) => {
        const result = CALENDAR.solar2lunar(item.year, item.month, item.day);
        console.log("result", result);
        return result.IDayCn;
      }
  );
</script>
```

## index.vue

```html
<template>
  <view>
    <view class="flex items-center">
      <view
        v-for="weekNum in computedWeekDays"
        :key="weekNum"
        class="flex flex-1 shrink-0 items-center justify-center"
      >
        <slot
          name="weekItem"
          :week-num="weekNum"
          :week-label="weekDaysMap[weekNum]"
        >
          {{ weekDaysMap[weekNum] }}
        </slot>
      </view>
    </view>
    <view
      v-for="(week, weekIndex) in (mouthDayList.length / 7)"
      :key="weekIndex"
    >
      <view class="flex items-center">
        <view
          v-for="value in mouthDayList.slice(weekIndex * 7, (weekIndex + 1) * 7)"
          :key="value.date"
          class="flex flex-1 shrink-0 items-center justify-center"
        >
          <slot name="day" :value="value" :week="week" :week-index="weekIndex">
            {{ value.month }}-{{ value.day }}
          </slot>
        </view>
      </view>
    </view>
  </view>
</template>

<script lang="ts" setup>
  import dayjs from "@/utils/dayjs";
  import { computed } from "vue";

  export interface DropDownPropsType {
    currentDate?: string;
    startWeek?: 0 | 1 | 2 | 3 | 4 | 5 | 6;
  }

  defineOptions({
    addGlobalClass: true,
    virtualHost: true,
    styleIsolation: "shared",
  });

  const props = withDefaults(defineProps<DropDownPropsType>(), {
    currentDate: dayjs().format("YYYY-MM-DD"),
    startWeek: 1,
  });

  const weekDays = [0, 1, 2, 3, 4, 5, 6];

  const weekDaysMap: AnyObject = {
    0: "日",
    1: "一",
    2: "二",
    3: "三",
    4: "四",
    5: "五",
    6: "六",
  };

  const computedWeekDays = computed(() => {
    const index = weekDays.indexOf(props.startWeek);
    if (index === -1) {
      return weekDays;
    }
    return weekDays.slice(index).concat(weekDays.slice(0, index));
  });

  const getWeekDayIndex = (weekDay: number) => {
    return computedWeekDays.value.indexOf(weekDay);
  };

  const mouthDayList = computed(() => {
    const dayLength = dayjs(props.currentDate).daysInMonth();
    const year = dayjs(props.currentDate).year();
    const month = dayjs(props.currentDate).month() + 1;
    const list = [];
    for (let i = 1; i <= dayLength; i++) {
      const date = dayjs(`${year}-${month}-${i}`).format("YYYY-MM-DD");
      list.push({
        year,
        month,
        day: i,
        date,
        canClick: true,
        weekDay: dayjs(date).day(),
      });
    }

    const startDay = list[0];
    if (startDay.weekDay !== computedWeekDays.value[0]) {
      const diff = getWeekDayIndex(startDay.weekDay);
      for (let i = 0; i < diff; i++) {
        const date = dayjs(startDay.date)
          .subtract(i + 1, "day")
          .format("YYYY-MM-DD");
        list.unshift({
          year: dayjs(date).year(),
          month: dayjs(date).month() + 1,
          day: dayjs(date).date(),
          date,
          canClick: false,
          weekDay: startDay.weekDay - (i + 1),
        });
      }
    }

    if (list.length < 42) {
      const listEndDay = list[list.length - 1].date;
      const diffLength = 42 - list.length;
      for (let i = 0; i < diffLength; i++) {
        const date = dayjs(listEndDay)
          .add(i + 1, "day")
          .format("YYYY-MM-DD");
        list.push({
          year: dayjs(date).year(),
          month: dayjs(date).month() + 1,
          day: dayjs(date).date(),
          date,
          canClick: false,
          weekDay: (list[list.length - 1].weekDay + (i + 1)) % 7,
        });
      }
    }

    return list;
  });
</script>
```

import{a as e,u as t}from"../../../vue-router-DBqTrJEm.js";import{u as o}from"../../../vuex-C9rRLaBQ.js";import{c as a,d as r,b as l,S as i,a as n}from"../../store/actionType-CNHuB-Of.js";import{a as s}from"../../common/axios/index-CK6lisJl.js";import{m,i as p,d,e as u}from"../../common/util/methods-C08ehvW-.js";import{l as c}from"../../common/props/left-sidebar-props/index-Cvo_KCZG.js";import{l as h}from"../../components/left-sidebar/index-Bol_CprA.js";import{o as v}from"./components/home/other-type-BSQ7OpTy.js";import{i as f}from"./components/home/image-type-DVZNqCk4.js";import{_ as g}from"./components/home/markdown-type.vue_vue_type_script_lang-D6jnzwnn.js";import{_ as y}from"../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as x}from"../../../@vue-reactivity-mdokXGQ5.js";import{b as j,e as w,N as b,U as k,m as _,a as T,g as L,j as M,l as P,F as D,s as S,c as q,x as C,y as E,n as I}from"../../../@vue-runtime-core-lkGMyH8G.js";import{k as N,n as W}from"../../../@vue-shared-LkD7rn4X.js";import"../../../@vue-devtools-api-CFGE8QBr.js";import"../../../axios-DPD4D5Qz.js";import"../../../__commonjsHelpers__-MdiGH4nz.js";import"../../../nprogress-DbBgBvvH.js";import"../../components/left-sidebar/index.vue_vue_type_script_lang-Bwox9K4v.js";import"../../../@vue-runtime-dom-ByoLcAZV.js";import"../../../@better-scroll-yEU79_0X.js";import"../../common/util/debounce-CNl5k4zp.js";import"../../components/left-sidebar/components/left-sidebar-item-DjsaJ_wE.js";import"../../components/left-sidebar/components/left-sidebar-item.vue_vue_type_script_lang-wyz9fK3k.js";import"../../components/left-sidebar/components/link-tag-V73iQm_N.js";import"../../components/commonm-btn/index-hUJDFDzu.js";import"../../components/left-sidebar/components/left-sidebar-search-std4THs7.js";import"../../../@vueuse-2ii6U9l7.js";import"./components/home/image-type.vue_vue_type_script_lang-xGwHAED-.js";import"../../../vite/preload-helper-Cu0sd_0_.js";import"../../../jquery-IViRahhZ.js";import"./components/home/navigator-title-BUhYgrbi.js";import"../../components/loading/loading-CS82ZUo3.js";const H={name:"view-home",components:{layoutLeftSidebar:h,markdownType:g,otherType:v,imageType:f},props:{...c},setup(c){const h=e(),v=t(),f=o(),g=x(""),y=x("ReadMe-前言"),b=x(""),k=x("文件"),_=x(!0);let T=()=>{};const L=j((()=>m(b.value))),M=j((()=>p(b.value))),P=j((()=>"link"===b.value)),D=j((()=>f.state.menuData.menuList)),S=()=>{I().then((()=>{document.querySelector(".home").scrollTop=0}))},q=e=>{const t=e.split("-");try{let a={children:D.value};if(t.forEach((e=>{a=a.children[+e]})),!a)return h.push("/");if(Object.prototype.hasOwnProperty.call(a,"children"))throw new Error("不合法的路由参数");if(f.dispatch(l,{indexPage:e}),f.dispatch(i,e),f.dispatch(n,{indexPage:e}),a&&a.link)return o=a.link,_.value=!1,b.value="link",y.value="链接",g.value=o,void window.open(o);const r=a.url[a.url.length-1].split(".");b.value=r[r.length-1]?r[r.length-1]:"";const m=`./${a.url.join("/")}`;if(y.value=a.url.join(" > "),_.value=!0,M.value)return(e=>{g.value=e,S()})(m);if(L.value)return(e=>{const{promise:t,cancel:o}=d(s.get(e));T({type:"cancel"}),T=o,t.then((e=>{_.value=!1,g.value=u.find((e=>e.suffix===b.value.toLocaleLowerCase())).formatFun(e.data),S()})).catch((e=>{e.type&&"cancel"===e.type||(g.value="网络寄了，我哭哭~~",b.value="md",_.value=!1)}))})(m);((e,t)=>{k.value=e[e.length-1],g.value=t,S()})(a.url,m)}catch(a){h.push("/error")}var o};return w((()=>v.query),(()=>{f.dispatch(a).then((()=>{const e=v.query.indexPage||"";c.toggleMenu(!1),e?q(e):(f.dispatch(r,{indexPage:e}),(()=>{b.value="md",_.value=!0;const{promise:e,cancel:t}=d(s.get("./README.md"));T({type:"cancel"}),T=t,e.then((e=>{_.value=!1,g.value=e.data})).catch((e=>{e.type&&"cancel"===e.type||(_.value=!1,g.value="寄拉！")}))})())}))}),{immediate:!0}),{menuList:D,markdownType:L,markdownTitleWidth:x("300px"),imageType:M,linkType:P,loading:_,htmlMD:g,title:y,fileSuffix:b,downloadName:k,itemClick:e=>{e.indexPage!==v.query.indexPage&&h.push({path:"/",query:{indexPage:e.indexPage}})}}}},O={class:"content-inner bg-style text-[var(--global-primary-color)] text-[15px] overflow-hidden w-[100%] h-[100%] flex flex-row"},F=(e=>(C("data-v-edf33c34"),e=e(),E(),e))((()=>P("div",{class:"bg-image overflow-hidden w-[100%] h-[100%] absolute"},null,-1))),R={class:"home overflow-auto relative w-[100%] h-[100%]"},U={key:0,class:"w-[100%] flex items-center justify-center box-border px-[30px] py-[0] min-h-[70px] text-20px font-600 text-[var(--global-text-color)] border-b-1px border-b-solid border-b-[var(--global-border-color)]"},$={key:3,class:"p-[20px]"},A=["href"];const z=y(H,[["render",function(e,t,o,a,r,l){const i=b("layout-left-sidebar"),n=b("markdown-type"),s=b("image-type"),m=b("other-type"),p=k("loading");return _((T(),L("div",O,[M(i,{"left-sidebar-w":e.leftSidebarW,"if-show-menu":e.ifShowMenu,"if-larger":e.ifLarger,"header-h":e.headerH,"toggle-menu":e.toggleMenu,onItemClick:a.itemClick},null,8,["left-sidebar-w","if-show-menu","if-larger","header-h","toggle-menu","onItemClick"]),P("div",{style:W(e.ifLarger?{width:`calc(100% - ${e.leftSidebarW})`}:{width:"100%"}),class:"relative h-[100%]"},[F,P("div",R,[a.menuList.length?(T(),L(D,{key:0},[a.markdownType?S("",!0):(T(),L("div",U,N(a.title),1)),a.markdownType?(T(),q(n,{key:1,title:a.title,"markdown-title-width":a.markdownTitleWidth,loading:a.loading,"if-larger":e.ifLarger,"header-h":e.headerH,"html-m-d":a.htmlMD},null,8,["title","markdown-title-width","loading","if-larger","header-h","html-m-d"])):a.imageType?(T(),q(s,{key:2,"html-m-d":a.htmlMD,loading:a.loading,onImageLoad:t[0]||(t[0]=e=>a.loading=!1)},null,8,["html-m-d","loading"])):a.linkType?(T(),L("div",$,[P("a",{href:a.htmlMD,class:"text-[var(--global-text-color)]"},"链接： "+N(a.htmlMD),9,A)])):(T(),q(m,{key:4,"download-name":a.downloadName,"html-m-d":a.htmlMD},null,8,["download-name","html-m-d"]))],64)):S("",!0)])],4)])),[[p,!a.menuList.length]])}],["__scopeId","data-v-edf33c34"]]);export{z as default};

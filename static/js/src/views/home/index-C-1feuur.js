import{a as e,u as t}from"../../../vue-router-DhXt6nTE.js";import{u as o}from"../../../vuex-BhxYhhdL.js";import{d as a,c as r,S as l,a as i,b as n}from"../../store/actionType-BVA9uGQF.js";import{a as s}from"../../common/axios/index-B2NMWJBe.js";import{m,i as d,d as p,e as c}from"../../common/util/methods-C-Gwc4Ne.js";import{l as u}from"../../common/props/left-sidebar-props/index-Cvo_KCZG.js";import{l as h}from"../../components/left-sidebar/index-DKow128B.js";import{o as v}from"./components/home/other-type-B2KLayts.js";import{i as f}from"./components/home/image-type-PpIip-W8.js";import{_ as g}from"./components/home/markdown-type.vue_vue_type_script_lang-CXR1ajHD.js";import{_ as y}from"../../../plugin-vue_export-helper-BCo6x5W8.js";import{N as x,U as j,m as w,a as b,g as k,j as _,l as T,s as M,F as L,c as P,b as D,e as S,t as q,x as C,n as E}from"../../../@vue-runtime-core-DQcPG1cz.js";import{k as I,n as W}from"../../../@vue-shared-C0QUMStP.js";import{r as H}from"../../../@vue-reactivity-v2zUdFSg.js";import"../../../@vue-devtools-api-CFGE8QBr.js";import"../../../axios-CAFaAR0X.js";import"../../../__commonjsHelpers__-MdiGH4nz.js";import"../../../nprogress-DbBgBvvH.js";import"../../components/left-sidebar/index.vue_vue_type_script_lang-xwo_C-Pm.js";import"../../../@vue-runtime-dom-CmJM4nE0.js";import"../../../@better-scroll-DQq3duai.js";import"../../common/util/debounce-CNl5k4zp.js";import"../../components/left-sidebar/components/left-sidebar-item-uxk3NM7s.js";import"../../components/left-sidebar/components/left-sidebar-item.vue_vue_type_script_lang-DVWE-p73.js";import"../../components/left-sidebar/components/link-tag-B3LvW_NH.js";import"../../components/commonm-btn/index-Bp6UIeO3.js";import"../../components/left-sidebar/components/left-sidebar-search-B4uwjOU_.js";import"../../../@vueuse-BUPFo47n.js";import"./components/home/image-type.vue_vue_type_script_lang-DCak-DFF.js";import"../../../vite/preload-helper-Cu0sd_0_.js";import"../../../jquery-IViRahhZ.js";import"./components/home/navigator-title-vvgG9OHO.js";import"../../components/loading/loading-DJY11uwa.js";const N={name:"view-home",components:{layoutLeftSidebar:h,markdownType:g,otherType:v,imageType:f},props:{...u},setup(u){const h=e(),v=t(),f=o(),g=H(""),y=H("ReadMe-前言"),x=H(""),j=H("文件"),w=H(!0);let b=()=>{};const k=D((()=>m(x.value))),_=D((()=>d(x.value))),T=D((()=>"link"===x.value)),M=D((()=>f.state.menuData.menuList)),L=()=>{E().then((()=>{document.querySelector(".home").scrollTop=0}))},P=e=>{const t=e.split("-");try{let a={children:M.value};if(t.forEach((e=>{a=a.children[+e]})),!a)return h.push("/");if(Object.prototype.hasOwnProperty.call(a,"children"))throw new Error("不合法的路由参数");if(f.dispatch(l,{indexPage:e}),f.dispatch(i,e),f.dispatch(n,{indexPage:e}),a&&a.link)return o=a.link,w.value=!1,x.value="link",y.value="链接",g.value=o,void window.open(o);const r=a.url[a.url.length-1].split(".");x.value=r[r.length-1]?r[r.length-1]:"";const m=`./${a.url.join("/")}`;if(y.value=a.url.join(" > "),w.value=!0,_.value)return(e=>{g.value=e,L()})(m);if(k.value)return(e=>{const{promise:t,cancel:o}=p(s.get(e));b({type:"cancel"}),b=o,t.then((e=>{w.value=!1,g.value=c.find((e=>e.suffix===x.value.toLocaleLowerCase())).formatFun(e.data),L()})).catch((e=>{e.type&&"cancel"===e.type||(g.value="网络寄了，我哭哭~~",x.value="md",w.value=!1)}))})(m);((e,t)=>{j.value=e[e.length-1],g.value=t,L()})(a.url,m)}catch(a){h.push("/error")}var o};return S((()=>v.query),(()=>{f.dispatch(a).then((()=>{const e=v.query.indexPage||"";u.toggleMenu(!1),e?P(e):(f.dispatch(r,{indexPage:e}),(()=>{x.value="md",w.value=!0;const{promise:e,cancel:t}=p(s.get("./README.md"));b({type:"cancel"}),b=t,e.then((e=>{w.value=!1,g.value=e.data})).catch((e=>{e.type&&"cancel"===e.type||(w.value=!1,g.value="寄拉！")}))})())}))}),{immediate:!0}),{menuList:M,markdownType:k,markdownTitleWidth:H("300px"),imageType:_,linkType:T,loading:w,htmlMD:g,title:y,fileSuffix:x,downloadName:j,itemClick:e=>{e.indexPage!==v.query.indexPage&&h.push({path:"/",query:{indexPage:e.indexPage}})}}}},O={class:"content-inner bg-style text-[var(--global-primary-color)] text-[15px] overflow-hidden w-[100%] h-[100%] flex flex-row"},A=(e=>(q("data-v-edf33c34"),e=e(),C(),e))((()=>T("div",{class:"bg-image overflow-hidden w-[100%] h-[100%] absolute"},null,-1))),F={class:"home overflow-auto relative w-[100%] h-[100%]"},R={key:0,class:"w-[100%] flex items-center justify-center box-border px-[30px] py-[0] min-h-[70px] text-20px font-600 text-[var(--global-text-color)] border-b-1px border-b-solid border-b-[var(--global-border-color)]"},U={key:3,class:"p-[20px]"},$=["href"];const z=y(N,[["render",function(e,t,o,a,r,l){const i=x("layout-left-sidebar"),n=x("markdown-type"),s=x("image-type"),m=x("other-type"),d=j("loading");return w((b(),k("div",O,[_(i,{"left-sidebar-w":e.leftSidebarW,"if-show-menu":e.ifShowMenu,"if-larger":e.ifLarger,"header-h":e.headerH,"toggle-menu":e.toggleMenu,onItemClick:a.itemClick},null,8,["left-sidebar-w","if-show-menu","if-larger","header-h","toggle-menu","onItemClick"]),T("div",{style:W(e.ifLarger?{width:`calc(100% - ${e.leftSidebarW})`}:{width:"100%"}),class:"relative h-[100%]"},[A,T("div",F,[a.menuList.length?(b(),k(L,{key:0},[a.markdownType?M("",!0):(b(),k("div",R,I(a.title),1)),a.markdownType?(b(),P(n,{key:1,title:a.title,"markdown-title-width":a.markdownTitleWidth,loading:a.loading,"if-larger":e.ifLarger,"header-h":e.headerH,"html-m-d":a.htmlMD},null,8,["title","markdown-title-width","loading","if-larger","header-h","html-m-d"])):a.imageType?(b(),P(s,{key:2,"html-m-d":a.htmlMD,loading:a.loading,onImageLoad:t[0]||(t[0]=e=>a.loading=!1)},null,8,["html-m-d","loading"])):a.linkType?(b(),k("div",U,[T("a",{href:a.htmlMD,class:"text-[var(--global-text-color)]"},"链接： "+I(a.htmlMD),9,$)])):(b(),P(m,{key:4,"download-name":a.downloadName,"html-m-d":a.htmlMD},null,8,["download-name","html-m-d"]))],64)):M("",!0)])],4)])),[[d,!a.menuList.length]])}],["__scopeId","data-v-edf33c34"]]);export{z as default};

import{a as e,u as t}from"../../../vue-router-DBqTrJEm.js";import{u as o}from"../../../vuex-C9rRLaBQ.js";import{c as a,d as i,b as n,S as r,a as l}from"../../store/actionType-CNHuB-Of.js";import{a as s}from"../../common/axios/index-CK6lisJl.js";import{m,i as d,d as p,e as u}from"../../common/util/methods-G0pJ8i8C.js";import{l as c}from"../../common/props/left-sidebar-props/index-Cvo_KCZG.js";import{l as h}from"../../components/left-sidebar/index-DDc0eXkL.js";import{o as f}from"./components/home/other-type-CdXHMo6f.js";import{i as g}from"./components/home/image-type-BAC1QbQe.js";import{m as v}from"./components/home/markdown-type-BEnUA2xs.js";import{_ as y}from"../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as j}from"../../../@vue-reactivity-mdokXGQ5.js";import{b as w,e as k,N as b,U as x,m as _,a as T,g as L,j as M,l as P,F as q,s as D,c as S,x as C,y as I,n as E}from"../../../@vue-runtime-core-lkGMyH8G.js";import{k as H,n as W}from"../../../@vue-shared-LkD7rn4X.js";import"../../../@vue-devtools-api-CFGE8QBr.js";import"../../../axios-DPD4D5Qz.js";import"../../../__commonjsHelpers__-MdiGH4nz.js";import"../../../nprogress-DbBgBvvH.js";import"../../components/left-sidebar/index.vue_vue_type_script_lang-Ds4qu1Tm.js";import"../../../@vue-runtime-dom-Dkxbnx-0.js";import"../../../@better-scroll-yEU79_0X.js";import"../../common/util/debounce-CNl5k4zp.js";import"../../components/left-sidebar/components/left-sidebar-item-BJuW53he.js";import"../../components/left-sidebar/components/left-sidebar-item.vue_vue_type_script_lang-DRTV9SzG.js";import"../../components/left-sidebar/components/link-tag-B8JQ9hb0.js";import"../../components/commonm-btn/index-hUJDFDzu.js";import"../../components/left-sidebar/components/left-sidebar-search-C4m5HpGB.js";import"../../../@vueuse-CzS49P4w.js";import"./components/home/image-type.vue_vue_type_script_lang-BDXKvCDt.js";import"./components/home/markdown-type.vue_vue_type_script_lang-0hcCligI.js";import"../../../vite/preload-helper-Cu0sd_0_.js";import"../../../jquery-IViRahhZ.js";import"./components/home/navigator-title-0DVOkjVy.js";import"../../components/loading/loading-DeNHmGK8.js";const N={name:"view-home",components:{layoutLeftSidebar:h,markdownType:v,otherType:f,imageType:g},props:{...c},setup(c){const h=e(),f=t(),g=o(),v=j(""),y=j("ReadMe-前言"),b=j(""),x=j("文件"),_=j(!0);let T=()=>{};const L=w((()=>m(b.value))),M=w((()=>d(b.value))),P=w((()=>"link"===b.value)),q=w((()=>g.state.menuData.menuList)),D=()=>{E().then((()=>{document.querySelector(".home").scrollTop=0}))},S=e=>{const t=e.split("-");try{let a={children:q.value};if(t.forEach((e=>{a=a.children[+e]})),!a)return h.push("/");if(Object.prototype.hasOwnProperty.call(a,"children"))throw new Error("不合法的路由参数");if(g.dispatch(n,{indexPage:e}),g.dispatch(r,e),g.dispatch(l,{indexPage:e}),a&&a.link)return o=a.link,_.value=!1,b.value="link",y.value="链接",v.value=o,void window.open(o);const i=a.url[a.url.length-1].split(".");b.value=i[i.length-1]?i[i.length-1]:"";const m=`./${a.url.join("/")}`;if(y.value=a.url.join(" > "),_.value=!0,M.value)return(e=>{v.value=e,D()})(m);if(L.value)return(e=>{const{promise:t,cancel:o}=p(s.get(e));T({type:"cancel"}),T=o,t.then((e=>{_.value=!1,v.value=u.find((e=>e.suffix===b.value.toLocaleLowerCase())).formatFun(e.data),D()})).catch((e=>{e.type&&"cancel"===e.type||(v.value="网络寄了，我哭哭~~",b.value="md",_.value=!1)}))})(m);((e,t)=>{x.value=e[e.length-1],v.value=t,D()})(a.url,m)}catch(a){h.push("/error")}var o};return k((()=>f.query),(()=>{g.dispatch(a).then((()=>{const e=f.query.indexPage||"";c.toggleMenu(!1),e?S(e):(g.dispatch(i,{indexPage:e}),(()=>{b.value="md",_.value=!0;const{promise:e,cancel:t}=p(s.get("./README.md"));T({type:"cancel"}),T=t,e.then((e=>{_.value=!1,v.value=e.data})).catch((e=>{e.type&&"cancel"===e.type||(_.value=!1,v.value="寄拉！")}))})())}))}),{immediate:!0}),{menuList:q,markdownType:L,markdownTitleWidth:j("300px"),imageType:M,linkType:P,loading:_,htmlMD:v,title:y,fileSuffix:b,downloadName:x,itemClick:e=>{e.indexPage!==f.query.indexPage&&h.push({path:"/",query:{indexPage:e.indexPage}})}}}},R={class:"content-inner bg-white overflow-hidden width100 height100 flex flex-direction-row"},F=(e=>(C("data-v-9ad4f200"),e=e(),I(),e))((()=>P("div",{class:"bg-image overflow-hidden width100 height100 absolute"},null,-1))),G={class:"home overflow-auto relative width100 height100"},O={key:0,class:"title width100 flex align-items-center justify-content-center"},$={key:3,class:"link"},A=["href"];const J=y(N,[["render",function(e,t,o,a,i,n){const r=b("layout-left-sidebar"),l=b("markdown-type"),s=b("image-type"),m=b("other-type"),d=x("loading");return _((T(),L("div",R,[M(r,{"left-sidebar-w":e.leftSidebarW,"if-show-menu":e.ifShowMenu,"if-larger":e.ifLarger,"header-h":e.headerH,"toggle-menu":e.toggleMenu,onItemClick:a.itemClick},null,8,["left-sidebar-w","if-show-menu","if-larger","header-h","toggle-menu","onItemClick"]),P("div",{style:W(e.ifLarger?{width:`calc(100% - ${e.leftSidebarW})`}:{width:"100%"}),class:"relative height100"},[F,P("div",G,[a.menuList.length?(T(),L(q,{key:0},[a.markdownType?D("",!0):(T(),L("div",O,H(a.title),1)),a.markdownType?(T(),S(l,{key:1,title:a.title,"markdown-title-width":a.markdownTitleWidth,loading:a.loading,"if-larger":e.ifLarger,"header-h":e.headerH,"html-m-d":a.htmlMD},null,8,["title","markdown-title-width","loading","if-larger","header-h","html-m-d"])):a.imageType?(T(),S(s,{key:2,"html-m-d":a.htmlMD,loading:a.loading,onImageLoad:t[0]||(t[0]=e=>a.loading=!1)},null,8,["html-m-d","loading"])):a.linkType?(T(),L("div",$,[P("a",{href:a.htmlMD},"链接： "+H(a.htmlMD),9,A)])):(T(),S(m,{key:4,"download-name":a.downloadName,"html-m-d":a.htmlMD},null,8,["download-name","html-m-d"]))],64)):D("",!0)])],4)])),[[d,!a.menuList.length]])}],["__scopeId","data-v-9ad4f200"]]);export{J as default};

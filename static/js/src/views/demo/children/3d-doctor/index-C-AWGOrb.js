import"../../../../static/three-onEvent/index-lLfrwr1J.js";import{T as e,O as n,F as t}from"../../../../../three-DLFuJBtA.js";import{_ as i}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{o as a,t as o,a as r,g as l,x as d,y as s,l as c}from"../../../../../@vue-runtime-core-lkGMyH8G.js";import"../../../../../@vue-reactivity-mdokXGQ5.js";import"../../../../../@vue-shared-LkD7rn4X.js";const m={name:"view-demo-3d-doctor",setup(){let i,r,l,d,s,c,m,u,h,w,p,v,f,g,y,x;const M=()=>{if(null!==r&&r.children.length>3){r.children.pop();const e=document.getElementById("canvas");null!==e&&e.removeChild(e.firstChild),window.cancelAnimationFrame(m),window.removeEventListener("resize",E),j(i,r),r=null,l=null,i=null,c=null,d=null,s=null,m=null,h=null,w=null,p=null,v=null,f=null,g=null}},j=(n,t)=>{const i=function(e){let t=e.children.filter((e=>e));t.forEach((e=>{e.children.length?i(e):"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose(),e.clear&&e.clear())})),e.clear&&e.clear(n),t=null};try{i(t)}catch(a){}try{n.renderLists.dispose(),n.dispose(),n.forceContextLoss(),n.domElement=null,n.content=null,n=null}catch(a){}window.requestAnimationId&&cancelAnimationFrame(window.requestAnimationId),e.Cache.clear()},E=()=>{l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)};a((()=>{function a(){m=requestAnimationFrame(a),s.rotation.x+=0,s.rotation.y-=.004,d.rotation.x+=0,d.rotation.y-=.004,i.clear(),i.render(r,l)}(function o(){return new Promise((m=>{i=new e.WebGLRenderer({antialias:!0,alpha:!0}),i.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),i.setSize(window.innerWidth,window.innerHeight),i.autoClear=!1,i.setClearColor(0,0),document.getElementById("canvas").appendChild(i.domElement),r=new e.Scene,l=new e.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),u=new e.onEvent(r,l),p=new e.BoxGeometry(20,24,20),v=new e.MeshBasicMaterial({transparent:!0,opacity:0}),f=new e.Mesh(p,v),f.position.y=77,f.material.opacity=0,l.position.z=400;const j=()=>{alert("点击头部，2000ms后重新加载模型，模拟加载新模型"),f.off("click",j),M(),setTimeout((()=>{o().then((()=>a()))}),2e3)};f.on("click",j),r.add(f),c=new n(l,i.domElement),r.add(l),g=new t,g.load("demo-static/model/model1.fbx",(function(n){s=n,s.scale.set(1,1,1),s.position.x=0,s.position.y=-90,s.position.z=0,s.traverse((function(n){const t=new e.TextureLoader;t.load("demo-static/model/FBX.fbm/Heart_Bump_B.jpg",(function(e){n.material&&(n.material.map=e),n.material&&(n.material.needsUpdate=!0)}),void 0,(function(e){})),t.load("demo-static/model/FBX.fbm/Heart_B.jpg",(function(e){n.material&&(n.material.map=e),n.material&&(n.material.needsUpdate=!0)}),void 0,(function(e){}))})),r.add(s),m()}),void 0,(function(e){})),d=new e.Object3D,r.add(d),h=new e.TetrahedronGeometry(2,0),w=new e.MeshPhongMaterial({color:16777215,shading:e.FlatShading});for(let n=0;n<1e3;n++){const n=new e.Mesh(h,w);n.position.set(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize(),n.position.multiplyScalar(90+700*Math.random()),n.rotation.set(2*Math.random(),2*Math.random(),2*Math.random()),d.add(n)}y=new e.AmbientLight(10066329),r.add(y),x=[],x[0]=new e.DirectionalLight(16777215,1),x[0].position.set(1,0,0),x[1]=new e.DirectionalLight(1173691,1),x[1].position.set(.75,1,.5),x[2]=new e.DirectionalLight(8519881,1),x[2].position.set(-.75,-1,.5),r.add(x[0]),r.add(x[1]),r.add(x[2]),window.addEventListener("resize",E,!1)}))})().then((()=>a()))})),o((()=>{M(),j()}))}},u=e=>(d("data-v-d19820de"),e=e(),s(),e),h={class:"relative canvas-wrap"},w=[u((()=>c("div",{id:"canvas"},null,-1))),u((()=>c("div",{class:"absolute line-height-1 tips"}," 模型有3mb的大小，github加载很慢，能不能加载出来听天由命吧 ",-1)))];const p=i(m,[["render",function(e,n,t,i,a,o){return r(),l("div",h,w)}],["__scopeId","data-v-d19820de"]]);export{p as default};

import"../../../../static/three-onEvent/index-CR4nX7Lz.js";import{T as e,O as n,F as t}from"../../../../../three-DmcQ_-qn.js";import{_ as i}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{g as a,a as o,o as r,y as l,l as d,t as s,x as c}from"../../../../../@vue-runtime-core-DQcPG1cz.js";import"../../../../../@vue-reactivity-v2zUdFSg.js";import"../../../../../@vue-shared-C0QUMStP.js";const m={name:"view-demo-3d-doctor",setup(){let i,a,o,d,s,c,m,u,w,h,p,v,f,g,y,M;const x=()=>{if(null!==a&&a.children.length>3){a.children.pop();const e=document.getElementById("canvas");null!==e&&e.removeChild(e.firstChild),window.cancelAnimationFrame(m),window.removeEventListener("resize",j),L(i,a),a=null,o=null,i=null,c=null,d=null,s=null,m=null,w=null,h=null,p=null,v=null,f=null,g=null}},L=(n,t)=>{const i=function(e){let t=e.children.filter((e=>e));t.forEach((e=>{e.children.length?i(e):"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose(),e.clear&&e.clear())})),e.clear&&e.clear(n),t=null};try{i(t)}catch(a){}try{n.renderLists.dispose(),n.dispose(),n.forceContextLoss(),n.domElement=null,n.content=null,n=null}catch(a){}window.requestAnimationId&&cancelAnimationFrame(window.requestAnimationId),e.Cache.clear()},j=()=>{o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)};r((()=>{function r(){m=requestAnimationFrame(r),s.rotation.x+=0,s.rotation.y-=.004,d.rotation.x+=0,d.rotation.y-=.004,i.clear(),i.render(a,o)}(function l(){return new Promise((m=>{i=new e.WebGLRenderer({antialias:!0,alpha:!0}),i.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),i.setSize(window.innerWidth,window.innerHeight),i.autoClear=!1,i.setClearColor(0,0),document.getElementById("canvas").appendChild(i.domElement),a=new e.Scene,o=new e.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),u=new e.onEvent(a,o),p=new e.BoxGeometry(20,24,20),v=new e.MeshBasicMaterial({transparent:!0,opacity:0}),f=new e.Mesh(p,v),f.position.y=77,f.material.opacity=0,o.position.z=400;const L=()=>{alert("点击头部，2000ms后重新加载模型，模拟加载新模型"),f.off("click",L),x(),setTimeout((()=>{l().then((()=>r()))}),2e3)};f.on("click",L),a.add(f),c=new n(o,i.domElement),a.add(o),g=new t,g.load("demo-static/model/model1.fbx",(function(n){s=n,s.scale.set(1,1,1),s.position.x=0,s.position.y=-90,s.position.z=0,s.traverse((function(n){const t=new e.TextureLoader;t.load("demo-static/model/FBX.fbm/Heart_Bump_B.jpg",(function(e){n.material&&(n.material.map=e),n.material&&(n.material.needsUpdate=!0)}),void 0,(function(e){})),t.load("demo-static/model/FBX.fbm/Heart_B.jpg",(function(e){n.material&&(n.material.map=e),n.material&&(n.material.needsUpdate=!0)}),void 0,(function(e){}))})),a.add(s),m()}),void 0,(function(e){})),d=new e.Object3D,a.add(d),w=new e.TetrahedronGeometry(2,0),h=new e.MeshPhongMaterial({color:16777215,shading:e.FlatShading});for(let n=0;n<1e3;n++){const n=new e.Mesh(w,h);n.position.set(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize(),n.position.multiplyScalar(90+700*Math.random()),n.rotation.set(2*Math.random(),2*Math.random(),2*Math.random()),d.add(n)}y=new e.AmbientLight(10066329),a.add(y),M=[],M[0]=new e.DirectionalLight(16777215,1),M[0].position.set(1,0,0),M[1]=new e.DirectionalLight(1173691,1),M[1].position.set(.75,1,.5),M[2]=new e.DirectionalLight(8519881,1),M[2].position.set(-.75,-1,.5),a.add(M[0]),a.add(M[1]),a.add(M[2]),window.addEventListener("resize",j,!1)}))})().then((()=>r()))})),l((()=>{x(),L()}))}},u=e=>(s("data-v-914cda50"),e=e(),c(),e),w={class:"relative canvas-wrap"},h=[u((()=>d("div",{id:"canvas"},null,-1))),u((()=>d("div",{class:"absolute lh-none tips"}," 模型有3mb的大小，github加载很慢，能不能加载出来听天由命吧 ",-1)))];const p=i(m,[["render",function(e,n,t,i,r,l){return o(),a("div",w,h)}],["__scopeId","data-v-914cda50"]]);export{p as default};

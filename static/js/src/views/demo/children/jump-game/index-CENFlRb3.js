import{_ as e}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as t,a,u as l}from"../../../../../@vue-reactivity-UKyDGrvc.js";import{o,f as i,a as n,g as u,l as c,s}from"../../../../../@vue-runtime-core-hXVbjtl0.js";import{k as r}from"../../../../../@vue-shared-LkD7rn4X.js";const v={class:"relative w-[640px] mx-[auto] my-[20px]"},d={class:"absolute top-[10px] left-[10px] font-['Courier_New',_monospace] bg-[rgba(255,_255,_255,_0.9)] px-[20px] py-[10px] rounded-[8px] [box-shadow:0_2px_8px_rgba(0,_0,_0,_0.1)]"},h={key:0,class:"level-complete absolute top-2/4 left-2/4 -translate-x-1/2 -translate-y-1/2 text-[3em] text-[gold] [text-shadow:3px_3px_6px_rgba(0,_0,_0,_0.8)]"},x=40,f=e(Object.assign({name:"jump-game"},{__name:"index",setup(e){const f=t(null),p=t(0),y=t(3),m=t(!1),g=t(0),w=t(0),_=t(!1);let b=[[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,0,0,0,1,1,1,1,1,0,0,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,4,4,1,1,1,1,1,1],[0,0,0,2,0,0,0,3,2,0,0,0,2,0,0,0],[0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0],[0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,4,4,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,0,0,0,0,0,0,0,0,3,3,3,0,0],[0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0],[0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]];const k=a([...b[w.value]]),M=a({x:100,y:200,width:30,height:40,velocityX:0,velocityY:0,isGrounded:!1,canJump:!0});let Y=null,E=null;const G=new Set;function X(){M.x=100,M.y=200,M.velocityX=0,M.velocityY=0,M.isGrounded=!1,M.canJump=!0,m.value=!1,_.value=!1}function j(){if(_.value)return;g.value>0&&M.canJump&&M.isGrounded&&(M.velocityY=-14,M.isGrounded=!1,M.canJump=!1,g.value=0),M.velocityX=0,G.has("ArrowLeft")&&(M.velocityX=-5),G.has("ArrowRight")&&(M.velocityX=5),M.x+=M.velocityX,M.velocityY=Math.min(M.velocityY+.4,15),M.y+=M.velocityY;const e=k[0].length*x,t=k.length*x;M.x=Math.max(0,Math.min(M.x,e-M.width)),M.y=Math.min(M.y,t-M.height),function(){M.isGrounded=!1;[[M.x,M.y],[M.x+M.width,M.y],[M.x,M.y+M.height],[M.x+M.width,M.y+M.height]].forEach((([e,t])=>{const a=Math.floor(e/x),l=Math.floor(t/x);if(l>=0&&l<k.length&&a>=0&&a<k[0].length){const e=k[l][a];e&&function(e,t,a){const l={x:e*x,y:t*x,width:x,height:x},o=Math.min(M.x+M.width,l.x+l.width)-Math.max(M.x,l.x),i=Math.min(M.y+M.height,l.y+l.height)-Math.max(M.y,l.y);if(o<=0||i<=0)return;o<i?(M.x<l.x?M.x=l.x-M.width:M.x=l.x+l.width,M.velocityX=0):M.y<l.y?(M.y=l.y-M.height,M.velocityY=0,1===a&&(M.isGrounded=!0,M.canJump=!0)):(M.y=l.y+l.height,M.velocityY=0);switch(a){case 2:k[t][e]=0,p.value+=50;break;case 3:y.value-=1,y.value<=0&&(m.value=!0);break;case 4:w.value<b.length-1?(_.value=!0,setTimeout((()=>{w.value++,k.splice(0,k.length,...b[w.value]),X(),_.value=!1}),1500)):m.value=!0}}(a,l,e)}}))}()}function A(){m.value||(g.value>0&&g.value--,j(),Y.clearRect(0,0,Y.canvas.width,Y.canvas.height),k.forEach(((e,t)=>{e.forEach(((e,a)=>{e&&(Y.fillStyle=1===e?"#666666":2===e?"#bb88aa":3===e?"#ff4444":"#ffff00",Y.fillRect(a*x+1,t*x+1,38,38))}))})),Y.fillStyle="#44aa88",Y.fillRect(M.x,M.y,M.width,M.height),Y.fillStyle="black",Y.font="14px Arial",Y.fillText(`Y速度: ${M.velocityY.toFixed(1)}`,10,20),Y.fillText(`地面: ${M.isGrounded}`,10,40),document.activeElement!==f.value&&f.value&&f.value.focus&&f.value.focus(),E=requestAnimationFrame(A))}function J(e){G.add(e.code),"ArrowUp"!==e.code&&"Space"!==e.code||!M.canJump||(g.value=8)}function L(e){G.delete(e.code)}function S(){y.value=3,p.value=0,w.value=0,b=[[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,0,0,0,1,1,1,1,1,0,0,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,4,4,1,1,1,1,1,1],[0,0,0,2,0,0,0,3,2,0,0,0,2,0,0,0],[0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0],[0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[1,1,4,4,1,1,1,1,1,1,1,1,1,1,1,1],[3,3,3,0,0,0,0,0,0,0,0,3,3,3,0,0],[0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0],[0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]],k.splice(0,k.length,...b[w.value]),X(),A()}return o((()=>{Y=f.value.getContext("2d"),f.value.width=640,f.value.height=320,f.value.focus(),window.addEventListener("keydown",J),window.addEventListener("keyup",L),X(),A()})),i((()=>{cancelAnimationFrame(E),window.removeEventListener("keydown",J),window.removeEventListener("keyup",L)})),(e,t)=>(n(),u("div",v,[c("canvas",{class:"border-[2px] border-solid border-[#333] bg-[#eeeeff] focus:!outline-[3px_solid_#4caf50] focus:[box-shadow:0_0_15px_rgba(76,_175,_80,_0.8)]",ref_key:"gameCanvas",ref:f,tabindex:"0"},null,512),c("div",d,[c("div",null,"得分："+r(p.value),1),c("div",null,"生命："+r(y.value),1),c("div",null,"关卡："+r(w.value+1)+"/"+r(l(b).length),1),m.value?(n(),u("button",{key:0,class:"mt-[12px] px-[24px] py-[8px] bg-[#4caf50] text-[white] border-none rounded-[4px] cursor-pointer [transition:background_0.2s] focus:bg-[#45a048]",onClick:S},r(w.value<l(b).length-1?"重新开始":"再来一次"),1)):s("",!0)]),_.value?(n(),u("div",h," 关卡完成！ ")):s("",!0)]))}}),[["__scopeId","data-v-23867b2b"]]);export{f as default};

import{_ as e}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as a}from"../../../../../@vue-reactivity-UKyDGrvc.js";import{o as l,t,a as v,g as u,l as r,x as o,y as h}from"../../../../../@vue-runtime-core-hXVbjtl0.js";import{k as i}from"../../../../../@vue-shared-LkD7rn4X.js";const n=(e=>(o("data-v-d46a9c95"),e=e(),h(),e))((()=>r("h2",null,"游戏结束",-1))),s=10,y=e({__name:"index",setup(e){const o=a(null),h=a(null),y=a([{x:20,y:20}]),d=a({x:10,y:10}),c=a("right"),x=a(0),w=a([]),f=a(null);let g,m=200,p=!1;const k=()=>{h.value.clearRect(0,0,o.value.width,o.value.height),y.value.forEach((e=>{h.value.fillStyle="#00FF00",h.value.fillRect(e.x*s,e.y*s,s,s)})),h.value.fillStyle="#FF0000",h.value.beginPath(),h.value.arc(d.value.x*s+5,d.value.y*s+5,5,0,2*Math.PI),h.value.fill(),w.value.forEach((e=>{h.value.fillStyle="#888888",h.value.fillRect(e.x*s,e.y*s,e.width*s,e.height*s)}))},M=()=>{const e={...y.value[0]};switch(c.value){case"right":e.x++;break;case"left":e.x--;break;case"up":e.y--;break;case"down":e.y++}e.x=(e.x+o.value.width/s)%(o.value.width/s),e.y=(e.y+o.value.height/s)%(o.value.height/s),y.value.unshift(e),e.x===d.value.x&&e.y===d.value.y?(x.value++,I()):y.value.pop(),_()&&(clearInterval(g),f.value.style.display="block"),k()},I=()=>{let e;do{e={x:Math.floor(Math.random()*(o.value.width/s)),y:Math.floor(Math.random()*(o.value.height/s))}}while(y.value.some((a=>a.x===e.x&&a.y===e.y))||w.value.some((a=>e.x>=a.x&&e.x<a.x+a.width&&e.y>=a.y&&e.y<a.y+a.height)));d.value=e},b=()=>{const e=Math.floor(10*Math.random())+5;for(let a=0;a<e;a++){let e;const a=Math.floor(3*Math.random())+1,l=Math.floor(3*Math.random())+1;do{e={x:Math.floor(Math.random()*(o.value.width/s-a)),y:Math.floor(Math.random()*(o.value.height/s-l)),width:a,height:l}}while(y.value.some((a=>a.x>=e.x&&a.x<e.x+e.width&&a.y>=e.y&&a.y<e.y+e.height))||d.value.x>=e.x&&d.value.x<e.x+e.width&&d.value.y>=e.y&&d.value.y<e.y+e.height);w.value.push(e)}},_=()=>{const e=y.value[0];return y.value.slice(1).some((a=>a.x===e.x&&a.y===e.y))||w.value.some((a=>e.x>=a.x&&e.x<a.x+a.width&&e.y>=a.y&&e.y<a.y+a.height))},E=e=>{switch(e.key){case"ArrowRight":"left"!==c.value&&(c.value="right");break;case"ArrowLeft":"right"!==c.value&&(c.value="left");break;case"ArrowUp":"down"!==c.value&&(c.value="up");break;case"ArrowDown":"up"!==c.value&&(c.value="down");break;case" ":p||(p=!0,m=100,clearInterval(g),g=setInterval(M,m))}},L=e=>{" "===e.key&&(p=!1,m=200,clearInterval(g),g=setInterval(M,m))},j=()=>{y.value=[{x:20,y:20}],c.value="right",x.value=0,w.value=[],b(),I(),f.value.style.display="none",clearInterval(g),g=setInterval(M,m)};return l((()=>{h.value=o.value.getContext("2d"),b(),I(),k(),g=setInterval(M,m),window.addEventListener("keydown",E),window.addEventListener("keyup",L)})),t((()=>{clearInterval(g),window.removeEventListener("keydown",E),window.removeEventListener("keyup",L)})),(e,a)=>(v(),u("div",null,[r("canvas",{ref_key:"canvas",ref:o,class:"snake-canvas",width:"1200",height:"800"},null,512),r("p",null,"得分: "+i(x.value),1),r("div",{class:"dialog",ref_key:"dialog",ref:f},[n,r("p",null,"你的得分是: "+i(x.value),1),r("button",{onClick:j},"重新开始")],512)]))}},[["__scopeId","data-v-d46a9c95"]]);export{y as default};

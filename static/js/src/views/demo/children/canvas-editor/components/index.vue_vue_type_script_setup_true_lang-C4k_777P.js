import{E as e,a,v as n,J as l,n as t,u as c,t as o,F as u,N as m,p as i,R as s,V as r,T as p,b as d,c as v,I as b,d as x,P as h,e as k}from"../../../../../../@hufe921-DbjEUi5z.js";import{c as f,d as g,o as w}from"./mock-B-9x4WBB.js";import{f as y}from"../../../../../common/util/methods-C08ehvW-.js";import{m as C}from"../../../../../components/dialog/index-COZxfRIE.js";import{r as T,a as I}from"../../../../../../@vue-reactivity-UKyDGrvc.js";import{t as S,a as E,g as R,l as L,F as D,q as A,s as M,P as F,n as B,j as N}from"../../../../../../@vue-runtime-core-hXVbjtl0.js";import{k as P}from"../../../../../../@vue-shared-LkD7rn4X.js";const U={class:"h-[100vh] flex overflow-hidden relative"},j={class:"p-[30px] w-[400px] h-[calc(100%-60px)] shrink-0 overflow-auto bg-[#fff] flex flex-wrap gap-[20px] items-center"},H=["onClick"],z={key:1},O=["onChange"],_={key:0,class:"relative z-[20]"},G=["value"],Y={key:2,class:"flex items-center"},V=["onInput"],W={class:"shrink-0"},q=["value"],J={class:"shrink-0"},K=["value"],$={class:"canvas-editor shrink-0 p-[30px] w-[794px] h-[calc(100%-60px)] overflow-auto"},X={class:"comment shrink-0 flex-1 p-[30px] h-[calc(100%-60px)] overflow-auto"},Z=["data-id","onClick"],Q={class:"comment-item__title"},ee={class:"comment-item__info"},ae={class:"comment-item__info"},ne={class:"comment-item__content"},le=Object.assign({name:"canvas-editor"},{__name:"index",setup(le){const te=T(null),ce=e=>new Promise(((a,n)=>{const l=e.target.files[0],t=new FileReader;t.readAsArrayBuffer(l),t.onload=e=>{var l;const t=null==(l=null==e?void 0:e.target)?void 0:l.result;t instanceof ArrayBuffer?a(t):n(new Error("文件读取失败"))}})),oe=I({mode:e.EDIT,fileUpload:{docx:{ref:null,files:[],onChange:e=>{ce(e).then((e=>{me.command.executeImportDocx({arrayBuffer:e}),oe.fileUpload.docx.files=[]}))}},excel:{ref:null,files:[],onChange:e=>{ce(e).then((e=>{me.command.executeImportExcel({arrayBuffer:e}),oe.fileUpload.excel.files=[]}))}}},commandList:[],eventList:[{eventType:"rangeStyleChange",callback:e=>{}},{eventType:"visiblePageNoListChange",callback:e=>{}},{eventType:"intersectionPageNoChange",callback:e=>{}},{eventType:"pageSizeChange",callback:e=>{}},{eventType:"pageScaleChange",callback:e=>{}},{eventType:"contentChange",callback:()=>{}},{eventType:"controlChange",callback:e=>{}},{eventType:"controlContentChange",callback:e=>{}},{eventType:"pageModeChange",callback:e=>{}},{eventType:"saved",callback:e=>{}},{eventType:"zoneChange",callback:e=>{}},{eventType:"mousemove",callback:e=>{}},{eventType:"mouseenter",callback:e=>{}},{eventType:"mouseleave",callback:e=>{}},{eventType:"mousedown",callback:e=>{}},{eventType:"mouseup",callback:e=>{}},{eventType:"click",callback:e=>{}},{eventType:"positionContextChange",callback:e=>{}},{eventType:"imageSizeChange",callback:e=>{}}]}),ue=T(f);let me=null;return me=null,B((()=>{me=new a(te.value,{header:[{value:"这是一个test页眉",rowFlex:"center"}],main:g,footer:[{value:"这是一个test页脚",rowFlex:"center"}]},{...w,scrollContainerSelector:".canvas-editor"}),me.use(n),me.use(l),me.use(t),me.use(c),me.use(o),me.use(u),me.use(m),me.use(i),me&&(oe.commandList=[{name:"编辑模式",component:"select",options:[{value:e.EDIT,name:"编辑模式"},{value:e.CLEAN,name:"清洁模式"},{value:e.READONLY,name:"只读模式"},{value:e.FORM,name:"表单模式"},{value:e.PRINT,name:"打印模式"},{value:e.DESIGN,name:"设计模式"}],callback:e=>{me.command.executeMode(e.target.value)}},{name:"全选",component:"button",callback:()=>{me.command.executeSelectAll()}},{name:"向前删除",component:"button",callback:()=>{me.command.executeBackspace()}},{name:"撤回",component:"button",callback:()=>{me.command.executeUndo()}},{name:"撤回上次的撤回",component:"button",callback:()=>{me.command.executeRedo()}},{name:"格式刷-复制样式",component:"button",callback:()=>{me.command.executePainter({isDblclick:!1})}},{name:"清除样式",component:"button",callback:()=>{me.command.executeFormat()}},{name:"设置字体",component:"select",options:[{name:"Microsoft YaHei",value:"Microsoft YaHei"},{name:"华文宋体",value:"华文宋体"},{name:"华文黑体",value:"华文黑体"},{name:"华文仿宋",value:"华文仿宋"},{name:"华文楷体",value:"华文楷体"},{name:"华文琥珀",value:"华文琥珀"},{name:"华文楷体",value:"华文楷体"},{name:"华文隶书",value:"华文隶书"},{name:"华文新魏",value:"华文新魏"},{name:"华文行楷",value:"华文行楷"},{name:"华文中宋",value:"华文中宋"},{name:"华文彩云",value:"华文彩云"},{name:"Arial",value:"Arial"},{name:"Segoe UI",value:"Segoe UI"},{name:"Ink Free",value:"Ink Free"},{name:"Fantasy",value:"Fantasy"}],callback:e=>{me.command.executeFont(e.target.value)}},{name:"设置字号",component:"select",options:(()=>{const e=[];for(let a=1;a<100;a++)e.push({name:a,value:a});return e})(),callback:e=>{me.command.executeSize(+e.target.value)}},{name:"增大字号+",component:"button",callback:e=>{me.command.executeSizeAdd()}},{name:"减小字号-",component:"button",callback:e=>{me.command.executeSizeMinus()}},{name:"字体加粗",component:"button",callback:e=>{me.command.executeBold()}},{name:"字体斜体",component:"button",callback:e=>{me.command.executeItalic()}},{name:"下划线",component:"button",callback:e=>{me.command.executeUnderline()}},{name:"删除线",component:"button",callback:e=>{me.command.executeStrikeout()}},{name:"上标",component:"button",callback:e=>{me.command.executeSuperscript()}},{name:"下标",component:"button",callback:e=>{me.command.executeSubscript()}},{name:"字体颜色",component:"picker",callback:e=>{me.command.executeColor(e.target.value)}},{name:"高亮",component:"picker",callback:e=>{me.command.executeHighlight(e.target.value)}},{name:"标题设置",component:"select",options:[{name:"没有标题",value:""},{name:"一级标题",value:"first"},{name:"二级标题",value:"second"},{name:"三级标题",value:"third"},{name:"四级标题",value:"fourth"},{name:"五级标题",value:"fifth"},{name:"六级标题",value:"sixth"}],callback:e=>{me.command.executeTitle(e.target.value)}},{name:"列表设置",component:"select",options:[{name:"decimal",value:"ol-decimal"},{name:"checkbox",value:"ul-checkbox"},{name:"disc",value:"ul-disc"},{name:"circle",value:"ul-circle"},{name:"square",value:"ul-square"}],callback:e=>{const a=e.target.value.split("-");me.command.executeList(a[0],a[1])}},{name:"行对齐",component:"select",options:(()=>{const e=[];return Object.keys(s).forEach((a=>{e.push({name:a,value:s[a]})})),e})(),callback:e=>{me.command.executeRowFlex(e.target.value)}},{name:"行间距",component:"select",options:(()=>{const e=[];for(let a=.5;a<20;a+=.5)e.push({name:a,value:a});return e})(),callback:e=>{me.command.executeRowMargin(+e.target.value)}},{name:"插入表格",component:"button",callback:e=>{let a=3,n=3;C({title:"批注",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[F("行"),N("input",{value:a,onInput:e=>{a=+(+e.target.value).toFixed(0),a=a<=0?1:a},class:"ml-[10px]",type:"number"},null)]),N("div",null,[F("列"),N("input",{value:n,onInput:e=>{n=+(+e.target.value).toFixed(0),n=n<=0?1:n},class:"ml-[10px]",type:"number"},null)])]),confirm:e=>{me.command.executeInsertTable(a,n),e()}})}},{name:"向当前表格row上插入一行",component:"button",callback:e=>{me.command.executeInsertTableTopRow()}},{name:"向当前表格row下插入一行",component:"button",callback:e=>{me.command.executeInsertTableBottomRow()}},{name:"向当前表格col左插入一列",component:"button",callback:e=>{me.command.executeInsertTableLeftCol()}},{name:"向当前表格col右插入一列",component:"button",callback:e=>{me.command.executeInsertTableRightCol()}},{name:"删除当前行",component:"button",callback:e=>{me.command.executeDeleteTableRow()}},{name:"删除当前列",component:"button",callback:e=>{me.command.executeDeleteTableCol()}},{name:"删除表格",component:"button",callback:e=>{me.command.executeDeleteTable()}},{name:"合并表格",component:"button",callback:e=>{me.command.executeMergeTableCell()}},{name:"取消合并表格",component:"button",callback:e=>{me.command.executeCancelMergeTableCell()}},{name:"分隔当前单元格（垂直方向）",component:"button",callback:e=>{me.command.executeSplitVerticalTableCell()}},{name:"分隔当前单元格（水平方向）",component:"button",callback:e=>{me.command.executeSplitHorizontalTableCell()}},{name:"表格单元格垂直对齐方式",component:"select",options:(()=>{const e=[];return Object.keys(r).forEach((a=>{e.push({name:a,value:r[a]})})),e})(),callback:e=>{me.command.executeTableTdVerticalAlign(e.target.value)}},{name:"表格边框类型",component:"select",options:(()=>{const e=[];return Object.keys(p).forEach((a=>{e.push({name:a,value:p[a]})})),e})(),callback:e=>{me.command.executeTableBorderType(e.target.value)}},{name:"表格边框颜色",component:"picker",callback:e=>{me.command.executeTableBorderColor(e.target.value)}},{name:"表格单元格边框类型",component:"select",options:(()=>{const e=[];return Object.keys(d).forEach((a=>{e.push({name:a,value:d[a]})})),e})(),callback:e=>{me.command.executeTableTdBorderType(e.target.value)}},{name:"表格单元格内斜线",component:"select",options:(()=>{const e=[];return Object.keys(v).forEach((a=>{e.push({name:a,value:v[a]})})),e})(),callback:e=>{me.command.executeTableTdSlashType(e.target.value)}},{name:"表格单元格背景色",component:"picker",callback:e=>{me.command.executeTableTdBackgroundColor(e.target.value)}},{name:"选中整个表格",component:"button",callback:e=>{me.command.executeTableSelectAll()}},{name:"插入图片",component:"button",callback:e=>{let a={value:"",width:150,height:150,imgDisplay:b.INLINE};C({title:"插入图片",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("插入对齐方式")]),N("select",{onChange:()=>{a.imgDisplay=event.target.value}},[Object.keys(b).map((e=>N("option",{key:e,value:b[e]},[e])))])]),N("div",null,[N("div",null,[F("插入图片")]),N("input",{class:"w-full shrink-0",type:"file",accept:"image/*",onChange:e=>{for(let n=0;n<event.target.files.length;n++)y(event.target.files[n]).then((e=>{const n=new Image;n.src=e,n.onload=l=>{a.width=150,a.height=n.height/n.width*150,a.value=e}}))},placeholder:"插入图片"},null)])]),confirm:e=>{me.command.executeImage(a),e()}})}},{name:"插入链接",component:"button",callback:e=>{let a="https://awen-blog.netlify.app/",n="Awen的博客";C({title:"插入链接",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("插入文本")]),N("input",{class:"w-full shrink-0",value:n,onInput:e=>{n=e.target.value},placeholder:"插入文本"},null)]),N("div",null,[N("div",null,[F("插入链接")]),N("input",{class:"w-full shrink-0",value:a,onInput:e=>{a=e.target.value},placeholder:"插入链接"},null)])]),confirm:e=>{me.command.executeHyperlink({type:x.HYPERLINK,value:"",url:a,valueList:n.split("").map((e=>({value:e,size:16})))}),e()}})}},{name:"删除链接",component:"button",callback:e=>{me.command.executeDeleteHyperlink()}},{name:"取消链接",component:"button",callback:e=>{me.command.executeCancelHyperlink()}},{name:"编辑链接",component:"button",callback:e=>{let a="https://awen-blog.netlify.app/";const n=me.command.getRangeContext();n&&n.startElement&&n.startElement.type===x.HYPERLINK&&(a=n.startElement.url),C({title:"编辑链接",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",null,[N("div",null,[F("编辑链接")]),N("div",null,[F("如若编辑没生效，将光标置于超链接后再点击编辑按钮")]),N("input",{class:"w-full shrink-0",value:a,onInput:e=>{a=e.target.value},placeholder:"编辑链接"},null)])]),confirm:e=>{me.command.executeEditHyperlink(a),e()}})}},{name:"插入分割线",component:"button",callback:e=>{let a="";C({title:"插入分割线",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("插入分割线(分割线线段以英文逗号分割，奇数位是实线，偶数位是虚线)")]),N("select",{onChange:e=>{a=e.target.value}},[[{name:"3,1",value:"3,1"},{name:"1,3",value:"1,3"},{name:"3,3",value:"3,3"}].map((e=>N("option",{key:e.name,value:e.value},[e.name])))])]),N("div",null,[N("div",null,[F("自己输入")]),N("input",{class:"w-full shrink-0",onInput:e=>{a=e.target.value}},null)])]),confirm:e=>{let n=[];try{n=a.split(",").map((e=>+e))}catch(l){n=[0,0]}me.command.executeSeparator(n),e()}})}},{name:"分页符",component:"button",callback:e=>{me.command.executePageBreak()}},{name:"添加水印",component:"button",callback:e=>{let a={data:"test水印",color:"",size:16,opacity:100,repeat:!0,gap:[0,0]};C({title:"添加水印",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("内容")]),N("input",{class:"w-full shrink-0",value:a.data,onInput:e=>{a.data=e.target.value}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("颜色")]),N("input",{class:"w-full shrink-0",type:"color",value:a.color,onInput:e=>{a.color=e.target.value}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("字体大小")]),N("input",{class:"w-full shrink-0",value:a.size,onInput:e=>{const n=+e.target.value;a.size=n>0?n:0}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("透明度")]),N("input",{class:"w-full shrink-0",value:a.opacity,onInput:e=>{const n=+e.target.value;a.opacity=n>100?100:n<0?0:n}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("是否重复")]),N("select",{onChange:e=>{a.repeat=!!+e.target.value}},[N("option",{value:"1"},[F("是")]),N("option",{value:"0"},[F("否")])])]),N("div",{class:"mb-[10px]"},[N("div",null,[F("水平间隔")]),N("input",{class:"w-full shrink-0",value:a.gap[0],onInput:e=>{const n=+e.target.value;a.gap[0]=n<0?0:n}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("垂直间隔")]),N("input",{class:"w-full shrink-0",value:a.gap[1],onInput:e=>{const n=+e.target.value;a.gap[1]=n>0?n:0}},null)])]),confirm:e=>{me.command.executeAddWatermark(a),e()}})}},{name:"删除水印",component:"button",callback:e=>{me.command.executeDeleteWatermark()}},{name:"搜索",component:"button",callback:e=>{let a="";C({title:"搜索",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("搜索内容")]),N("input",{class:"w-full shrink-0",value:a,onInput:e=>{a=e.target.value}},null)])]),confirm:e=>{me.command.executeSearch(a),e()}})}},{name:"搜索内容上一个",component:"button",callback:e=>{me.command.executeSearchNavigatePre()}},{name:"搜索内容下一个",component:"button",callback:e=>{me.command.executeSearchNavigateNext()}},{name:"替换当前搜索的内容",component:"button",callback:e=>{let a="";C({title:"替换当前搜索的内容",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("替换当前搜索的内容")]),N("input",{class:"w-full shrink-0",value:a,onInput:e=>{a=e.target.value}},null)])]),confirm:e=>{me.command.executeReplace(a),e()}})}},{name:"打印",component:"button",callback:e=>{me.command.executePrint()}},{name:"设置缩放比例",component:"button",callback:e=>{let a="";C({title:"设置缩放比例",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("设置缩放比例(0-100)")]),N("input",{class:"w-full shrink-0",type:"number",value:a,onInput:e=>{a=e.target.value},val:!0},null)])]),confirm:e=>{me.command.executePageScale(+a>0?+a/100:1),e()}})}},{name:"恢复页面原始缩放比例",component:"button",callback:e=>{me.command.executePageScaleRecovery()}},{name:"页面缩小",component:"button",callback:e=>{me.command.executePageScaleMinus()}},{name:"页面放大",component:"button",callback:e=>{me.command.executePageScaleAdd()}},{name:"设置纸张",component:"button",callback:e=>{let a={width:100,height:100,paperDirection:h.HORIZONTAL,paperMargin:[10,10,10,10]};C({title:"设置缩放比例",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("宽")]),N("input",{class:"w-full shrink-0",type:"number",value:a.width,onInput:e=>{let n=+e.target.value;n=n>0?n:10,a.width=n}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("高")]),N("input",{class:"w-full shrink-0",type:"number",value:a.height,onInput:e=>{let n=+e.target.value;n=n>0?n:10,a.height=n}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("纸张方向")]),N("select",{onChange:e=>{a.paperDirection=e.target.value}},[Object.keys(h).map((e=>N("option",{key:e,value:h[e]},[e])))]),["上边距","下边距","左边距","右边距"].map(((e,n)=>N("div",{class:"mb-[10px]",key:e},[N("div",null,[e]),N("input",{class:"w-full shrink-0",type:"number",value:a.paperMargin[n],onInput:e=>{let l=+e.target.value;l=l>0?l:10,a.paperMargin[n]=l}},null)])))])]),confirm:e=>{me.command.executePaperSize(a.width,a.height),me.command.executePaperDirection(a.paperDirection),me.command.executeSetPaperMargin(a.paperMargin),e()}})}},{name:"设置正文徽章",component:"button",callback:e=>{let a={width:150,height:150,value:"",top:0,left:0};C({title:"插入图片",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("top")]),N("input",{class:"w-full shrink-0",type:"number",value:a.top,onInput:e=>{let n=+e.target.value;n=n>0?n:0,a.top=n}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("left")]),N("input",{class:"w-full shrink-0",type:"number",value:a.left,onInput:e=>{let n=+e.target.value;n=n>0?n:0,a.left=n}},null)]),N("div",null,[N("div",null,[F("插入图片")]),N("input",{class:"w-full shrink-0",type:"file",accept:"image/*",onChange:e=>{for(let n=0;n<event.target.files.length;n++)y(event.target.files[n]).then((e=>{const n=new Image;n.src=e,n.onload=l=>{a.width=150,a.height=n.height/n.width*150,a.value=e}}))},placeholder:"插入图片"},null)])]),confirm:e=>{me.command.executeSetMainBadge(a),e()}})}},{name:"文字工具（删除空行、行首空格）",component:"button",callback:e=>{me.command.executeWordTool()}},{name:"设置编辑器 HTML 数据",component:"button",callback:e=>{let a={header:"<h1>header11</h1>",main:"<h1>main11</h1>",footer:"<h1>foote11r</h1>"};C({title:"设置编辑器",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("header")]),N("textarea",{class:"w-full shrink-0",type:"number",value:a.header,onInput:e=>{a.header=e.target.value}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("main")]),N("textarea",{class:"w-full shrink-0",type:"number",value:a.main,onInput:e=>{a.main=e.target.value}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("footer")]),N("textarea",{class:"w-full shrink-0",value:a.footer,onInput:e=>{a.footer=e.target.value}},null)])]),confirm:e=>{me.command.executeSetHTML(a),e()}})}},{name:"获取当前文档信息",component:"button",callback:e=>{me.command.getValueAsync().then((e=>{const a=JSON.stringify(e);C({title:"获取当前文档信息",contentContent:N("div",{class:"w-full flex-1 overflow-auto shrink-0"},[a])})}))}},{name:"插入公式",component:"button",callback:e=>{let a={name:"老公式",value:"Awen = Mc2"};C({title:"插入公式",contentContent:N("div",{class:"w-full flex-1 overflow-auto shrink-0"},[N("div",{class:"mb-[10px]"},[N("div",null,[F("老公式名称")]),N("textarea",{class:"w-full shrink-0",value:a.name,onInput:e=>{a.name=e.target.value}},null)]),N("div",{class:"mb-[10px]"},[N("div",null,[F("老公式")]),N("textarea",{class:"w-full shrink-0",value:a.value,onInput:e=>{a.value=e.target.value}},null)])]),confirm:e=>{me.command.executeInsertElementList([{value:a.name},{value:a.value,type:x.LATEX},{value:"\n"}]),e()}})}}]),me&&me.register.contextMenuList([{name:"批注",when:e=>!e.isReadonly&&e.editorHasSelection&&e.zone===k.MAIN,callback:e=>{let a="";C({title:"批注",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("textarea",{class:"w-[calc(100%-40px)] h-[calc(100%-40px)] shrink-0 p-[20px] border border-[#ccc] rounded-[5px]",value:a,onInput:e=>{a=e.target.value},placeholder:"请输入批注"},null)]),confirm:n=>{if(!a)return;const l=e.executeSetGroup();l&&(ue.value.push({id:l,content:a,userName:"Awen",rangeText:e.getRangeText(),createdDate:(new Date).toLocaleString()}),n())}})}},{name:"签名",icon:"signature",when:e=>!e.isReadonly&&e.editorTextFocus,callback:e=>{let a=C({title:"签名",contentContent:N("div",{class:"w-full flex-1 shrink-0"},[N("input",{class:"w-full shrink-0",type:"file",accept:"image/*",onChange:n=>{for(let l=0;l<event.target.files.length;l++)y(event.target.files[l]).then((n=>{const l=new Image;l.src=n,l.onload=t=>{e.executeInsertElementList([{value:n,width:150,height:l.height/l.width*150,type:x.IMAGE}]),a.app.unmount()}}))},placeholder:"请上传签名"},null),N("div",{id:"image-preview"},null)])})}},{name:"格式整理",icon:"word-tool",when:e=>!e.isReadonly,callback:e=>{e.executeWordTool()}},{name:"插入条形码",when:e=>!e.isReadonly&&e.editorTextFocus,callback:e=>{const a=window.prompt("请输入内容");e.executeInsertBarcode1D(a,200,100)}},{name:"插入二维码",when:e=>!e.isReadonly&&e.editorTextFocus,callback:e=>{const a=window.prompt("请输入内容");e.executeInsertBarcode2D(a,200,200)}},{name:"插入代码块",when:e=>!e.isReadonly&&e.editorTextFocus,callback:e=>{const a=window.prompt("请输入内容");e.executeInsertCodeblock(a)}},{name:"导出文档",when:e=>!0,callback:e=>{e.executeExportDocx({fileName:"Awen23333"})}},{name:"导入文档",when:e=>!0,callback:e=>{oe.fileUpload.docx.ref.click()}},{name:"导入excel",when:e=>!0,callback:e=>{oe.fileUpload.excel.ref.click()}},{name:"打开/编辑流程图",when:e=>!e.isReadonly&&e.editorTextFocus,callback:(e,a)=>{var n;const l=null==(n=a.startElement)?void 0:n.extension,t="diagram"===(null==l?void 0:l.name)?l.xml:"";e.executeLoadDiagram({data:t,onDestroy:n=>{if(!n||!n.data)return;const{bounds:l}=n;t?e.executeUpdateElementById({id:a.startElement.id,properties:{width:l.width,height:l.height,value:n.data,extension:{name:"diagram",xml:n.xml}}}):e.executeInsertElementList([{type:x.IMAGE,width:l.width,height:l.height,value:n.data,extension:{name:"diagram",xml:n.xml}}])}})}},{name:"转成大写",when:e=>!e.isReadonly&&e.editorHasSelection,callback:e=>{e.executeUpperCase()}},{name:"转成小写",when:e=>!e.isReadonly&&e.editorHasSelection,callback:e=>{e.executeLowerCase()}}]),me&&oe.eventList.forEach((e=>{me.eventBus.off(e.eventType,e.callback),me.eventBus.on(e.eventType,e.callback)})),oe.commandList.find((e=>"select"===e.component)).callback({target:{value:oe.mode}})})),S((()=>{me&&oe.eventList.forEach((e=>{me.eventBus.off(e.eventType,e.callback)})),me&&me.destroy(),me=null})),(e,a)=>(E(),R("div",U,[L("div",j,[(E(!0),R(D,null,A(oe.commandList,((e,a)=>(E(),R("div",{class:"shrink-0",key:a},["button"===e.component?(E(),R("button",{onClick:e.callback,key:a},P(e.name),9,H)):M("",!0),"select"===e.component?(E(),R("div",z,[F(P(e.name)+": ",1),L("select",{onChange:e.callback},["select"===e.component?(E(),R("div",_,[(E(!0),R(D,null,A(e.options,((e,n)=>(E(),R("option",{key:`${a}-${n}`,value:e.value},P(e.name),9,G)))),128))])):M("",!0)],40,O)])):M("",!0),"picker"===e.component?(E(),R("div",Y,[F(P(e.name)+": ",1),L("input",{type:"color",onInput:e.callback},null,40,V)])):M("",!0)])))),128)),L("div",W,[F(" 插入文档(.docx) "),L("input",{type:"file",name:"file-docx",ref:e=>{oe.fileUpload.docx.ref=e},id:"",value:oe.fileUpload.docx.files,onChange:a[0]||(a[0]=(...e)=>oe.fileUpload.docx.onChange&&oe.fileUpload.docx.onChange(...e)),accept:".docx"},null,40,q)]),L("div",J,[F(" 插入文档(.xlsx) "),L("input",{type:"file",name:"file-excel",ref:e=>{oe.fileUpload.excel.ref=e},value:oe.fileUpload.excel.files,id:"",onChange:a[1]||(a[1]=(...e)=>oe.fileUpload.excel.onChange&&oe.fileUpload.excel.onChange(...e)),accept:".xlsx"},null,40,K)])]),L("div",$,[L("div",{ref_key:"canvasEditorRef",ref:te,class:""},null,512)]),L("div",X,[(E(!0),R(D,null,A(ue.value,((e,a)=>(E(),R("div",{class:"comment-item mb-[10px] p-[10px] border border-[#ccc] rounded-[5px] cursor-pointer",key:a,"data-id":e.id,onClick:a=>{return n=e.id,void me.command.getGroupIds().then((e=>{e.includes(n)?me.command.executeLocationGroup(n):me.command.executeDeleteGroup(n)}));var n}},[L("div",Q,P(e.rangeText),1),L("div",ee,P(e.createdDate),1),L("div",ae,P(e.userName),1),L("div",ne,P(e.content),1)],8,Z)))),128))])]))}});export{le as _};

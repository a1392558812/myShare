import{f as e}from"../../../../../@vueuse-D78rsaXS.js";import{b as a}from"../../../../common/util/methods-C08ehvW-.js";import{_ as l}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as o}from"../../../../../@vue-reactivity-mdokXGQ5.js";import{o as s,t,U as r,m as n,a as i,g as c,l as u,e as v,x as f,y as d}from"../../../../../@vue-runtime-core-lkGMyH8G.js";import{l as m}from"../../../../../@vue-shared-LkD7rn4X.js";import"../../../../../axios-DPD4D5Qz.js";import"../../../../../__commonjsHelpers__-MdiGH4nz.js";const g={name:"view-demo-canvas-scroll",setup(){const l=o(!0),r=o(null),n=o(null),i=o(null),c=e=>`${a()}demo-static/canvas-scroll/large_${e.toString().padStart(4,"0")}.jpg`,u=o((()=>{const e=[];for(let a=0;a<=121;a++){const l=c(a),o=new Image;o.src=l;const s={url:l,imageDom:o,ifLoad:!1};e.push(s),o.onload=()=>{u.value[a].ifLoad=!0,o.onload=null}}return e})()),f=e=>{const a=u.value[e];if(!1!==a.ifLoad)r.value.getContext("2d").drawImage(u.value[e].imageDom,0,0);else{const l=new Image;l.src=a.url,l.onload=()=>{u.value[e].ifLoad=!0,l.onload=null};const o=v((()=>u.value[e].ifLoad),(a=>{a&&(f(e),o())}))}},{y:d}=e(n,{onScroll:()=>{const e=i.value.offsetHeight-n.value.offsetHeight;let a=parseInt(d.value/e*u.value.length);a=a>u.value.length-1?u.value.length-1:a,f(a)}});return s((()=>{f(0),setTimeout((()=>{l.value=!1}),2500)})),t((()=>{u.value=[]})),{scrollCanvasRef:r,scrollWrapRef:n,scrollRef:i,loading:l}}},p=(e=>(f("data-v-7f9933e9"),e=e(),d(),e))((()=>u("div",{style:{left:"0",top:"0"},class:"fixed"},[u("div",null,"github-page资源访问较慢，这里做2.5s缓冲")],-1))),h={ref:"scrollRef",class:"relative scroll-target"},j={ref:"scrollCanvasRef",width:"1096",height:"724",class:"fixed align-center scroll-canvas"};const _=l(g,[["render",function(e,a,l,o,s,t){const v=r("loading");return n((i(),c("div",{ref:"scrollWrapRef",class:m([o.loading?"":"overflow-y-auto","relative scroll-canvas-wrap"])},[p,u("div",h,null,512),u("canvas",j,null,512)],2)),[[v,o.loading]])}],["__scopeId","data-v-7f9933e9"]]);export{_ as default};

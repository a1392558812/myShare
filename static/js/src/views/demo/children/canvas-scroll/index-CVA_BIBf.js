import{f as e}from"../../../../../@vueuse-C17lgTZK.js";import{b as a}from"../../../../common/util/methods-C08ehvW-.js";import{_ as l}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{o as s,t as o,U as t,m as r,a as n,g as i,l as c,e as u,x as v,y as f}from"../../../../../@vue-runtime-core-hXVbjtl0.js";import{r as d}from"../../../../../@vue-reactivity-UKyDGrvc.js";import{l as m}from"../../../../../@vue-shared-LkD7rn4X.js";import"../../../../../axios-DPD4D5Qz.js";import"../../../../../__commonjsHelpers__-MdiGH4nz.js";const g={name:"view-demo-canvas-scroll",setup(){const l=d(!0),t=d(null),r=d(null),n=d(null),i=e=>`${a()}demo-static/canvas-scroll/large_${e.toString().padStart(4,"0")}.jpg`,c=d((()=>{const e=[];for(let a=0;a<=121;a++){const l=i(a),s=new Image;s.src=l;const o={url:l,imageDom:s,ifLoad:!1};e.push(o),s.onload=()=>{c.value[a].ifLoad=!0,s.onload=null}}return e})()),v=e=>{const a=c.value[e];if(!1!==a.ifLoad)t.value.getContext("2d").drawImage(c.value[e].imageDom,0,0);else{const l=new Image;l.src=a.url,l.onload=()=>{c.value[e].ifLoad=!0,l.onload=null};const s=u((()=>c.value[e].ifLoad),(a=>{a&&(v(e),s())}))}},{y:f}=e(r,{onScroll:()=>{const e=n.value.offsetHeight-r.value.offsetHeight;let a=parseInt(f.value/e*c.value.length);a=a>c.value.length-1?c.value.length-1:a,v(a)}});return s((()=>{v(0),setTimeout((()=>{l.value=!1}),2500)})),o((()=>{c.value=[]})),{scrollCanvasRef:t,scrollWrapRef:r,scrollRef:n,loading:l}}},p=(e=>(v("data-v-7f9933e9"),e=e(),f(),e))((()=>c("div",{style:{left:"0",top:"0"},class:"fixed"},[c("div",null,"github-page资源访问较慢，这里做2.5s缓冲")],-1))),h={ref:"scrollRef",class:"relative scroll-target"},j={ref:"scrollCanvasRef",width:"1096",height:"724",class:"fixed align-center scroll-canvas"};const _=l(g,[["render",function(e,a,l,s,o,u){const v=t("loading");return r((n(),i("div",{ref:"scrollWrapRef",class:m([s.loading?"":"overflow-y-auto","relative scroll-canvas-wrap"])},[p,c("div",h,null,512),c("canvas",j,null,512)],2)),[[v,s.loading]])}],["__scopeId","data-v-7f9933e9"]]);export{_ as default};

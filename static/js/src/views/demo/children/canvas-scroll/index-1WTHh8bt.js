import{f as e}from"../../../../../@vueuse-BUPFo47n.js";import{b as a}from"../../../../common/util/methods-C-Gwc4Ne.js";import{_ as l}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{U as s,m as o,g as t,a as r,l as n,o as i,y as c,t as u,x as v,e as f}from"../../../../../@vue-runtime-core-DQcPG1cz.js";import{l as d}from"../../../../../@vue-shared-C0QUMStP.js";import{r as m}from"../../../../../@vue-reactivity-v2zUdFSg.js";import"../../../../../axios-CAFaAR0X.js";import"../../../../../__commonjsHelpers__-MdiGH4nz.js";const g={name:"view-demo-canvas-scroll",setup(){const l=m(!0),s=m(null),o=m(null),t=m(null),r=e=>`${a()}demo-static/canvas-scroll/large_${e.toString().padStart(4,"0")}.jpg`,n=m((()=>{const e=[];for(let a=0;a<=121;a++){const l=r(a),s=new Image;s.src=l;const o={url:l,imageDom:s,ifLoad:!1};e.push(o),s.onload=()=>{n.value[a].ifLoad=!0,s.onload=null}}return e})()),u=e=>{const a=n.value[e];if(!1!==a.ifLoad)s.value.getContext("2d").drawImage(n.value[e].imageDom,0,0);else{const l=new Image;l.src=a.url,l.onload=()=>{n.value[e].ifLoad=!0,l.onload=null};const s=f((()=>n.value[e].ifLoad),(a=>{a&&(u(e),s())}))}},{y:v}=e(o,{onScroll:()=>{const e=t.value.offsetHeight-o.value.offsetHeight;let a=parseInt(v.value/e*n.value.length);a=a>n.value.length-1?n.value.length-1:a,u(a)}});return i((()=>{u(0),setTimeout((()=>{l.value=!1}),2500)})),c((()=>{n.value=[]})),{scrollCanvasRef:s,scrollWrapRef:o,scrollRef:t,loading:l}}},p=(e=>(u("data-v-7f9933e9"),e=e(),v(),e))((()=>n("div",{style:{left:"0",top:"0"},class:"fixed"},[n("div",null,"github-page资源访问较慢，这里做2.5s缓冲")],-1))),h={ref:"scrollRef",class:"relative scroll-target"},j={ref:"scrollCanvasRef",width:"1096",height:"724",class:"fixed align-center scroll-canvas"};const _=l(g,[["render",function(e,a,l,i,c,u){const v=s("loading");return o((r(),t("div",{ref:"scrollWrapRef",class:d([i.loading?"":"overflow-y-auto","relative scroll-canvas-wrap"])},[p,n("div",h,null,512),n("canvas",j,null,512)],2)),[[v,i.loading]])}],["__scopeId","data-v-7f9933e9"]]);export{_ as default};

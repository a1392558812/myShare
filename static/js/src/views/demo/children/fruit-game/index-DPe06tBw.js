import{_ as e}from"../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as t}from"../../../../../@vue-reactivity-v2zUdFSg.js";import{y as a,g as l,a as s,s as n,l as o,T as r,F as i,q as u,t as v,x as c}from"../../../../../@vue-runtime-core-DQcPG1cz.js";import{k as p,l as x,n as d}from"../../../../../@vue-shared-C0QUMStP.js";const m=e=>(v("data-v-794a339f"),e=e(),c(),e),h={class:"w-screen h-screen overflow-hidden bg-[linear-gradient(135deg,_#7f7fd5_0%,_#86a8e7_50%,_#91eae4_100%)] select-none [font-family:Arial,sans-serif] relative"},f={key:0,class:"w-full h-full flex flex-col items-center justify-center text-[white] text-center p-8 box-border"},_=m((()=>o("h1",{class:"text-[3rem] mb-4 [text-shadow:0_2px_10px_rgba(0,_0,_0,_0.3)]"},"水果忍者",-1))),y=m((()=>o("p",{class:"text-[1.2rem] mb-8 max-w-[500px]"},"滑动屏幕切水果，避开炸弹！",-1))),g=r('<div class="flex justify-center gap-[2rem] mt-12" data-v-794a339f><div class="flex flex-col items-center gap-[0.5rem] text-[white]" data-v-794a339f><span class="text-[1.8rem] [text-shadow:0_2px_5px_rgba(0,_0,_0,_0.2)]" data-v-794a339f>✋</span><span data-v-794a339f>滑动切水果</span></div><div class="flex flex-col items-center gap-[0.5rem] text-[white]" data-v-794a339f><span class="text-[1.8rem] [text-shadow:0_2px_5px_rgba(0,_0,_0,_0.2)]" data-v-794a339f>💣</span><span data-v-794a339f>避开炸弹💣</span></div><div class="flex flex-col items-center gap-[0.5rem] text-[white]" data-v-794a339f><span class="text-[1.8rem] [text-shadow:0_2px_5px_rgba(0,_0,_0,_0.2)]" data-v-794a339f>❤️</span><span data-v-794a339f>❤️没了游戏结束</span></div></div>',1),b={key:1,class:"w-full h-full relative"},w={class:"absolute top-[0] left-[0] right-[0] p-4 flex justify-between items-center text-[white] z-10 bg-[rgba(0,_0,_0,_0.1)]"},M={class:"flex items-center gap-[0.5rem] text-[1.1rem] [text-shadow:0_1px_3px_rgba(0,_0,_0,_0.3)]"},j=m((()=>o("span",null,"⭐",-1))),I={class:"flex items-center gap-[0.2rem] text-[1.1rem] [text-shadow:0_1px_3px_rgba(0,_0,_0,_0.3)]"},k={class:"flex items-center gap-[0.5rem] text-[1.1rem] [text-shadow:0_1px_3px_rgba(0,_0,_0,_0.3)]"},$=m((()=>o("span",null,"⚡",-1))),C={key:0},S={key:1,class:"absolute w-full h-full flex items-center justify-center select-none"},T={class:"absolute -translate-x-[20%] translate-y-[0] -rotate-[15deg] opacity-80"},z={class:"absolute translate-x-[20%] translate-y-[0] rotate-[15deg] opacity-80"},q={key:2,class:"end-screen w-full h-full flex flex-col items-center justify-center text-[white] bg-[rgba(0,_0,_0,_0.5)] text-center p-8 box-border"},B=m((()=>o("h2",{class:"text-[2.5rem] mb-6"},"游戏结束",-1))),R={class:"mb-8"},E=m((()=>o("span",{class:"text-[1.2rem] opacity-80"},"最终得分",-1))),P={class:"text-[3rem] mx-[0] my-2 [font-weight:bold]"},X={class:"flex gap-[3rem] mb-8"},Y={class:"text-center"},A=m((()=>o("span",{class:"text-[1rem] opacity-80 block"},"水果切数",-1))),D={class:"text-[1.5rem] ml-[0] mr-[0] my-2"},F={class:"text-center"},G=m((()=>o("span",{class:"text-[1rem] opacity-80 block"},"最高等级",-1))),H={class:"text-[1.5rem] ml-[0] mr-[0] my-2"},J=e({__name:"index",setup(e){const r=t("start"),v=t(0),c=t(6),m=t(1),J=t(0),K=t(0),L=t(""),N=t({x:0,y:0}),O=t(0),Q=t([]),U=t([]),V=t([]),W=t(""),Z=t(0),ee=t(!1),te=t(1500),ae=t(1),le=t(50),se=[{type:"fruit",emoji:"🍎",points:10},{type:"fruit",emoji:"🍋",points:10},{type:"fruit",emoji:"🍓",points:15},{type:"fruit",emoji:"🍇",points:10},{type:"fruit",emoji:"🍉",points:20},{type:"bomb",emoji:"💣",points:-30}];let ne=null,oe=null;const re=()=>{r.value="playing",v.value=0,c.value=6,m.value=1,J.value=0,K.value=0,Q.value=[],L.value="",te.value=1500,ae.value=1,le.value=50,ie(),ne=setInterval(ce,16)},ie=()=>{oe=setInterval((()=>{"playing"===r.value&&ve()}),te.value)},ue=()=>{const e=Math.random()<.2,t=e?se.find((e=>"bomb"===e.type)):se[Math.floor(Math.random()*(se.length-1))],a=80*Math.random()+10,l=(60*Math.random()-30)*(Math.PI/180),s=ae.value*(.8+.4*Math.random()),n=Math.sin(l)*s,o=-Math.cos(l)*s;return{id:Date.now()+Math.random(),...t,x:a,y:100,vx:n,vy:o,gravity:.015,rotation:360*Math.random(),rotationSpeed:2*(Math.random()-.5),sliced:!1,opacity:1,size:e?40:36+8*Math.random()}},ve=()=>{const e=[];for(let t=0;t<m.value&&Q.value.length+t<le.value;t++)e.push(ue());Q.value=Q.value.concat(e)},ce=()=>{for(let e=Q.value.length-1;e>=0;e--){const t=Q.value[e];t.sliced?(t.opacity-=.1,t.opacity<=0&&Q.value.splice(e,1)):(t.x+=t.vx,t.y+=t.vy,t.vy+=t.gravity,t.rotation+=t.rotationSpeed,t.vy=Math.min(t.vy,3),(t.y>110||t.x<-10||t.x>110)&&Q.value.splice(e,1))}pe(),xe()},pe=()=>{const e=Math.floor(v.value/100)+1;e>m.value&&(m.value=e,te.value=Math.max(500,1500-80*(m.value-1)),ae.value=1+.1*(m.value-1),le.value=Math.min(10,5+Math.floor((m.value-1)/2)))},xe=()=>{c.value<6&&v.value-K.value>=100&&(c.value++,K.value=v.value,de("+1 生命!",50,50))},de=(e,t,a)=>{L.value=e,N.value={x:t,y:a},O.value=1,setTimeout((()=>{const e=setInterval((()=>{O.value-=.05,O.value<=0&&(clearInterval(e),L.value="")}),30)}),1e3)},me=()=>{r.value="end",clearInterval(ne),clearInterval(oe)},he=()=>{clearInterval(ne),clearInterval(oe),re()},fe=e=>{ee.value=!0,V.value=[],ge(e),be(),Z.value=1},_e=e=>{ee.value&&(ge(e),be(),we())},ye=()=>{ee.value=!1;const e=setInterval((()=>{Z.value-=.1,Z.value<=0&&(clearInterval(e),V.value=[],be())}),50)},ge=e=>{const t=e.type.includes("touch")?e.touches[0].clientX:e.clientX,a=e.type.includes("touch")?e.touches[0].clientY:e.clientY,l=document.querySelector(".game-area");if(!l)return;const s=l.getBoundingClientRect(),n=(t-s.left)/s.width*100,o=(a-s.top)/s.height*100;V.value.push({x:n,y:o}),V.value.length>30&&V.value.shift()},be=()=>{if(V.value.length<2)return void(W.value="");let e="polygon(";V.value.forEach(((t,a)=>{e+=`${t.x}% ${t.y}%, `}));for(let t=V.value.length-1;t>=0;t--){const a=V.value[t];e+=`${a.x+2}% ${a.y+2}%, `}e=e.slice(0,-2)+")",W.value=e},we=()=>{if(!U.value.length||V.value.length<2)return;const e=V.value[V.value.length-1],t=V.value[V.value.length-2];U.value.forEach(((a,l)=>{const s=Q.value[l];if(!s||s.sliced)return;const n=a.getBoundingClientRect(),o=document.querySelector(".game-area");if(!o)return;const r=o.getBoundingClientRect(),i=(n.left+n.width/2-r.left)/r.width*100,u=(n.top+n.height/2-r.top)/r.height*100,v=Math.max(n.width,n.height)/r.width*50;Me(t.x,t.y,e.x,e.y,i,u)<v&&je(l,i,u)}))},Me=(e,t,a,l,s,n)=>{const o=Math.pow(a-e,2)+Math.pow(l-t,2);if(0===o)return Math.hypot(s-e,n-t);let r=((s-e)*(a-e)+(n-t)*(l-t))/o;r=Math.max(0,Math.min(1,r));const i=e+r*(a-e),u=t+r*(l-t);return Math.hypot(s-i,n-u)},je=(e,t,a)=>{const l=Q.value[e];l&&!l.sliced&&(l.sliced=!0,"fruit"===l.type?(v.value+=l.points,J.value++,de(`+${l.points}`,t,a)):"bomb"===l.type&&(v.value=Math.max(0,v.value+l.points),c.value=Math.max(0,c.value-1),c.value<=0&&me(),de(`${l.points}`,t,a)))};return a((()=>{clearInterval(ne),clearInterval(oe)})),(e,t)=>(s(),l("div",h,["start"===r.value?(s(),l("div",f,[_,y,o("button",{onClick:re,class:"start-button px-8 py-[0.8rem] text-[1.2rem] bg-[#ff6b6b] text-[white] border-none rounded-[30px] cursor-pointer [transition:all_0.3s_ease] [box-shadow:0_4px_15px_rgba(0,_0,_0,_0.2)]"},"开始游戏"),g])):"playing"===r.value?(s(),l("div",b,[o("div",w,[o("div",M,[j,o("span",null,"分数: "+p(v.value),1)]),o("div",I,[(s(),l(i,null,u(6,(e=>o("span",{key:e,class:x({"heart-lost":e>c.value})},"❤️",2))),64))]),o("div",k,[$,o("span",null,"等级: "+p(m.value),1)])]),L.value?(s(),l("div",{key:0,class:"absolute text-[white] [font-weight:bold] [text-shadow:0_2px_4px_rgba(0,_0,_0,_0.3)] pointer-events-none [transition:opacity_0.3s_ease] animate-[float-up_1s_ease_forwards]",style:d({left:`${N.value.x}%`,top:`${N.value.y}%`,opacity:O.value})},p(L.value),5)):n("",!0),o("div",{class:"game-area w-full h-full relative overflow-hidden",onMousedown:fe,onMousemove:_e,onMouseup:ye,onTouchstart:fe,onTouchmove:_e,onTouchend:ye},[(s(!0),l(i,null,u(Q.value,((e,t)=>(s(),l("div",{key:e.id,class:x(["game-item",e.type]),style:d({left:`${e.x}%`,top:`${e.y}%`,transform:`translate(-50%, -50%) rotate(${e.rotation}deg)`,opacity:e.opacity,fontSize:`${e.size}px`}),ref_for:!0,ref_key:"gameItems",ref:U},[e.sliced?n("",!0):(s(),l("span",C,p(e.emoji),1)),e.sliced?(s(),l("div",S,[o("span",T,p(e.emoji),1),o("span",z,p(e.emoji),1)])):n("",!0)],6)))),128)),o("div",{class:"absolute top-[0] left-[0] w-full h-full bg-[rgba(255,_255,_255,_0.5)] pointer-events-none [transition:opacity_0.1s_ease]",style:d({"clip-path":W.value,opacity:Z.value})},null,4)],32)])):"end"===r.value?(s(),l("div",q,[B,o("div",R,[E,o("p",P,p(v.value),1)]),o("div",X,[o("div",Y,[A,o("p",D,p(J.value),1)]),o("div",F,[G,o("p",H,p(m.value),1)])]),o("button",{onClick:he,class:"restart-button px-8 py-[0.8rem] text-[1.2rem] bg-[#4ecdc4] text-[white] border-none rounded-[30px] cursor-pointer [transition:all_0.3s_ease] [box-shadow:0_4px_15px_rgba(0,_0,_0,_0.2)]"},"再玩一次")])):n("",!0)]))}},[["__scopeId","data-v-794a339f"]]);export{J as default};

import{a as e}from"../../../../../../../@vue-runtime-dom-ByoLcAZV.js";import{_ as t}from"../../../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as a}from"../../../../../../../@vue-reactivity-mdokXGQ5.js";import{b as l,e as s,n as p,t as r,a as i,g as u,l as n,s as o,m as d,x as c,y as m}from"../../../../../../../@vue-runtime-core-lkGMyH8G.js";import{n as v,k as f}from"../../../../../../../@vue-shared-LkD7rn4X.js";const g=e=>(c("data-v-f028f253"),e=e(),m(),e),y={class:"toggle-btn-wrap"},x={key:0,class:"toggle-btn"},b={style:{"margin-right":"10px"}},V=["value"],w={class:"iframe-wrap"},U={class:"textarea-warp"},j=g((()=>n("div",{class:"textarea-title"},"template",-1))),k={class:"textarea-warp"},h=g((()=>n("div",{class:"textarea-title"},"script",-1))),A={class:"textarea-warp"},O=g((()=>n("div",{class:"textarea-title"},"css",-1))),R={class:"textarea-warp"},S=g((()=>n("div",{class:"textarea-title"},"imports",-1))),L=t(Object.assign({name:"view-demo-playground2-plane"},{__name:"index",props:{mode:{type:String,default:"edit"},templateValue:{type:String,default:"<div></div>"},cssValue:{type:String,default:""},scriptValue:{type:String,default:"export default { setup() {} }"},imports:{type:Object,default:()=>({vue:"https://unpkg.com/vue@3/dist/vue.esm-browser.js"})},beforeAppMount:{type:String,default:';console.log("🐮 --- beforeAppMount");'},afterAppMount:{type:String,default:';console.log("🐮 --- afterAppMount", app);'}},emits:["update:templateValue","update:scriptValue","update:cssValue","update:imports"],setup(t,{emit:c}){const m=t,g=c,L=a(""),M=a(null),_=a(50);let $="",J="";const N=l({get:()=>m.templateValue,set(e){g("update:templateValue",e)}}),B=l({get:()=>m.scriptValue,set(e){g("update:scriptValue",e)}}),C=l({get:()=>m.cssValue,set(e){g("update:cssValue",e)}}),F=l({get:()=>JSON.stringify(m.imports),set(e){g("update:imports",JSON.parse(e))}}),I=e=>{const t=+e.target.value;_.value=t?t>100?100:t<0?0:t:0},T=()=>{URL.revokeObjectURL($),URL.revokeObjectURL(J),$="",J=""};return s((()=>[m.templateValue,m.scriptValue,m.cssValue,m.imports,m.beforeAppMount,m.afterAppMount]),((e,t)=>{p().then((()=>{T(),$=URL.createObjectURL(new Blob([m.scriptValue],{type:"text/javascript;charset=UTF-8"})),J=URL.createObjectURL(new Blob([`<style>\nhtml, body{ padding: 0; margin: 0 }\n${m.cssValue}\n</style>\n<script type="importmap">\n  {\n    "imports": `+JSON.stringify(m.imports)+`\n  }\n<\/script>\n\n<div id="app"></div>\n\n<script type="module">\n  import { createApp } from 'vue'\n  import option from '${$}'\n\n  ;${m.beforeAppMount};\n\n  ;const app = createApp({\n    template: '${m.templateValue.replace(/\n/g,"")}',\n    ...option\n  })\n\n  ;${m.afterAppMount};\n\n  ;app.mount('#app')\n<\/script>`],{type:"text/html;charset=UTF-8"})),M.value.src=J}))}),{immediate:!0}),s((()=>m.mode),((e,t)=>{e!==t&&(L.value=e)}),{immediate:!0}),r((()=>{T()})),(t,a)=>(i(),u("div",null,[n("div",y,[n("div",{class:"toggle-btn",style:v("preview"===L.value?{background:"pink"}:{}),onClick:a[0]||(a[0]=e=>L.value="preview")}," preview模式 ",4),n("div",{class:"toggle-btn",style:v("edit"===L.value?{background:"pink"}:{}),onClick:a[1]||(a[1]=e=>L.value="edit")}," edit模式 ",4),"edit"===L.value?(i(),u("div",x,[n("label",b,"编辑器宽度: "+f(_.value)+"%",1),n("input",{style:{width:"40px"},type:"number",value:_.value,onInput:I},null,40,V)])):o("",!0)]),n("div",w,["edit"===L.value?(i(),u("div",{key:0,class:"content-wrap",style:v({width:`${_.value}%`})},[n("div",U,[j,d(n("textarea",{class:"textarea-item","onUpdate:modelValue":a[2]||(a[2]=e=>N.value=e)},null,512),[[e,N.value]])]),n("div",k,[h,d(n("textarea",{class:"textarea-item","onUpdate:modelValue":a[3]||(a[3]=e=>B.value=e)},null,512),[[e,B.value]])]),n("div",A,[O,d(n("textarea",{class:"textarea-item","onUpdate:modelValue":a[4]||(a[4]=e=>C.value=e)},null,512),[[e,C.value]])]),n("div",R,[S,d(n("textarea",{class:"textarea-item","onUpdate:modelValue":a[5]||(a[5]=e=>F.value=e)},null,512),[[e,F.value]])])],4)):o("",!0),n("iframe",{style:{flex:1},class:"iframe-item",ref_key:"iframeRef",ref:M},null,512)])]))}}),[["__scopeId","data-v-f028f253"]]);export{L as c};

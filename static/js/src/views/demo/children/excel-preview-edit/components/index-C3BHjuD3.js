import{$ as e}from"../../../../../../jquery-IViRahhZ.js";import{e as t,v as l}from"../../../../../../@vue-runtime-dom-DvlG2p-m.js";import{e as o}from"./export-BQzOrlnm.js";import{c as s}from"../../../../../common/util/typeCheck-CZoBiYEg.js";import{L as a}from"../../../../../../luckyexcel-Dx5CjN_p.js";import{b as n}from"../../../../../common/util/methods-C08ehvW-.js";import{_ as r}from"../../../../../../plugin-vue_export-helper-BCo6x5W8.js";import{r as c}from"../../../../../../@vue-reactivity-Bg8cIJPh.js";import{o as i,a as u,g as d,l as m,m as v,F as x,q as f,x as h,y as k}from"../../../../../../@vue-runtime-core-C-ht4TMg.js";import{k as p}from"../../../../../../@vue-shared-LkD7rn4X.js";const g=e=>(h("data-v-e068df9b"),e=e(),k(),e),w={class:"flex"},y=g((()=>m("div",{class:"luckysheet-wrap"},[m("div",{class:"relative w-[100%] h-[100%]"},[m("div",{id:"luckysheet"})])],-1))),b={class:"flex-1"},j={class:"block control-btn"},C={class:"block control-btn"},_=g((()=>m("span",{style:{"margin-right":"1em"}},"åŠ è½½è¿œç¨‹æ–‡ä»¶:",-1))),I=g((()=>m("option",{disabled:"",value:""},"é€‰æ‹©è¿œç¨‹æ–‡ä»¶",-1))),G=["value"],L={id:"tip"},U=r(Object.assign({name:"excel-preview-edit-index"},{__name:"index",setup(r){const h=n(),k=c(!1),g=c(""),U=c({}),q=`${h}demo-static/excel-preview-edit/images/avatar.jpg`,B=c([{text:"01test.xlsx",value:`${h}demo-static/excel-preview-edit/mock-file/01test.xlsx`},{text:"02test.xlsx",value:`${h}demo-static/excel-preview-edit/mock-file/02test.xlsx`}]),F=e=>{window.luckysheet.create({container:"luckysheet",data:e.sheets,title:e.info.name,plugins:["chart"],lang:"zh",userInfo:e.info.name.creator,myFolderUrl:"/"})},T=()=>{var e;s(null==(e=null==window?void 0:window.luckysheet)?void 0:e.destroy)&&window.luckysheet.destroy()},V=e=>{const t=e.target.files;if(null==t||0===t.length)return void alert("æœªå¯¼å…¥æ–‡ä»¶");const l=t[0].name.split(".");"xlsx"===l[l.length-1]?(k.value=!0,a.transformExcelToLucky(t[0],(function(e,t){null!=e.sheets&&0!==e.sheets.length?(U.value=e,k.value=!1,T(),F(e)):alert("æ— æ³•è¯»å–excelæ–‡ä»¶çš„å†…å®¹ï¼Œå½“å‰ä¸æ”¯æŒxlsä»¥å¤–æ–‡ä»¶ï¼")}))):alert("å½“å‰ä¸æ”¯æŒxlsä»¥å¤–æ–‡ä»¶ï¼")},$=e=>{const t=g.value,l=e.target.options[e.target.selectedIndex].innerText;""!==t&&(k.value=!0,a.transformExcelToLuckyByUrl(t,l,((e,t)=>{null!=e.sheets&&0!==e.sheets.length?(U.value=e,k.value=!1,T(),F(e)):alert("æ— æ³•è¯»å–excelæ–‡ä»¶çš„å†…å®¹ï¼Œå½“å‰ä¸æ”¯æŒxlsä»¥å¤–æ–‡ä»¶ï¼")})))},z=()=>{o(window.luckysheet.getAllSheets(),"ğŸ˜¡ğŸ˜¡excel")},A=()=>{var e;s(null==(e=null==window?void 0:window.luckysheet)?void 0:e.destroy)&&window.luckysheet.setCellValue(4,5,{ct:{fa:"General",t:"g"},bg:"#ff0",fc:"#990000",m:"69",v:69,ps:{value:"ä»‹æ˜¯ä¸ªæ’å…¥çš„å€¼"}})},E=()=>{window.luckysheet.setRangeValue([[{m:"value1",ct:{fa:"General",t:"g"},v:"value1"},{m:"value3",ct:{fa:"General",t:"g"},v:"value3"}],[{m:"value2",ct:{fa:"General",t:"g"},v:"value2"},{m:"value4",ct:{fa:"General",t:"g"},v:"value4"}]],{range:{row:[3,4],column:[3,4]},success:()=>{}})},D=()=>{window.luckysheet.insertImage(q,{order:0,rowIndex:5,colIndex:5})};return i((()=>{window.luckysheet.create({container:"luckysheet",title:"æ— å†…é¬¼ï¼Œæ•´ç‚¹excelæ–‡ä»¶",lang:"zh",column:26,row:26,chart:!0,myFolderUrl:"/",plugins:["chart"],userInfo:{userImage:q,userName:"æˆ‘æ˜¯é»‘æ‰‹å“¥"},functionButton:'<button class="custom-function-button">é«˜çº§buttonæ’å…¥</button>',hook:{workbookCreateAfter:t=>{e(".luckysheet_info_detail_user").click((()=>{alert("ç‚¹ç‚¹ç‚¹ï¼Œç‚¹ä»€ä¹ˆç‚¹ï¼Œç–¯ç‹‚æ‹·æ‰“ä½ ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼")})),e(".custom-function-button").click((()=>{alert("è¿™ä»¿ä½›æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰é«˜çº§button")}))}}})})),(e,o)=>(u(),d("div",w,[y,m("div",b,[m("div",j,[m("input",{id:"uploadBtn",type:"file",onChange:V},null,32)]),m("div",C,[_,v(m("select",{style:{"margin-right":"1em"},"onUpdate:modelValue":o[0]||(o[0]=e=>g.value=e),onChange:$},[I,(u(!0),d(x,null,f(B.value,(e=>(u(),d("option",{key:e.text,value:e.value},p(e.text),9,G)))),128))],544),[[t,g.value]])]),m("button",{class:"block control-btn",onClick:z},"ä¸‹è½½å½“å‰xlsx"),m("button",{class:"block control-btn",onClick:A},"è®¾ç½®3è¡Œ4åˆ—çš„æ•°æ®ä¸º69"),m("button",{class:"block control-btn",onClick:E}," è®¾ç½®(ç¬¬3è¡Œ-ç¬¬4è¡Œ)ä¸(ç¬¬3åˆ—-ç¬¬4åˆ—)äº¤ç•Œå¤„çš„æ•°æ® "),m("button",{class:"block control-btn",onClick:D},"è®¾ç½®(5,5)å¤„æ’å…¥å›¾ç‰‡")]),v(m("div",L,"Downloading",512),[[l,k.value]])]))}}),[["__scopeId","data-v-e068df9b"]]);export{U as e};

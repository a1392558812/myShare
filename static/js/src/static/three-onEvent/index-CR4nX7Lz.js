import{T as e}from"../../../three-DmcQ_-qn.js";(e=>{const n={gaze:{},click:{},hover:{}},t=[],c={},o={};Object.keys(n).forEach((function(e,n){c[e]={flag:!1,listener:function(n){o[e](n,i.camera)}}}));var i={};function r(e){const n=[];for(const t in e){const c=e[t].object3d;n.push(c)}return a(n)}function a(e){let n=[];for(const t in e)"Group"===e[t].type?n=n.concat(a(e[t].children)):n.push(e[t]);return n}function l(e,n){return s(e,n)}function s(e,n){return e[n.id]?e[n.id]:s(e,n.parent)}e.onEvent=function(e,n){i.scene=e||{},i.camera=n||{}},e.onEvent.prototype.removeAll=function(){for(const e in n)for(const t in n[e])delete n[e][t]},e.onEvent.prototype.update=function(){for(const e in t)t[e]()},Object.assign(e.Object3D.prototype,{on:function(e,t,o){if(c.hasOwnProperty(e)){n[e][this.id]={object3d:this,callback:Array.from(arguments).slice(1)};const t=c[e];t.flag||(t.flag=!0,t.listener(n[e]))}},off:function(e){if(e)c.hasOwnProperty(e)&&delete n[e][this.id];else for(const t in n)delete n[t][this.id]}}),o.gaze=function(n,c){let o,i,a=!1;const s=new e.Raycaster;t.push((function(){if(n){let t=[];s.setFromCamera(new e.Vector2,c),t=r(n);const f=s.intersectObjects(t);f.length>0?a||(a=!0,o=f[0].object,i=l(n,o),i.callback[0]&&i.callback[0](o)):(a&&i.callback[1]&&i.callback[1](o),a=!1)}}))},o.click=function(n,t){let c,o,i=!1;const a=new e.Raycaster;window.addEventListener("mousedown",(function(s){if(s.preventDefault(),!n)return;let f=[];a.setFromCamera(new e.Vector2(s.clientX/window.innerWidth*2-1,-s.clientY/window.innerHeight*2+1),t),f=r(n);const u=a.intersectObjects(f);if(u.length>0){if(i)return;i=!0,c=u[0].object,o=l(n,c)}else i=!1}),!1),window.addEventListener("mousemove",(function(e){e.preventDefault(),i&&(i=!1)}),!1),window.addEventListener("mouseup",(function(e){e.preventDefault(),i&&o.callback[0]&&o.callback[0](c),i=!1}),!1)},o.hover=function(n,t){let c,o,i=!1;const a=new e.Raycaster;window.addEventListener("mousemove",(function(s){if(s.preventDefault(),!n)return;let f=[];a.setFromCamera(new e.Vector2(s.clientX/window.innerWidth*2-1,-s.clientY/window.innerHeight*2+1),t),f=r(n);const u=a.intersectObjects(f);if(u.length>0){if(i)return;i=!0,c=u[0].object,o=l(n,c),o.callback[0]&&o.callback[0](c)}else i&&o.callback[1]&&o.callback[1](c),i=!1}),!1)}})(e);

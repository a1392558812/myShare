## createRenderer

> createRenderer å‡½æ•°æ¥å—ä¸¤ä¸ªæ³›å‹å‚æ•°ï¼š `HostNode` å’Œ `HostElement`ï¼Œå¯¹åº”äºå®¿ä¸»ç¯å¢ƒä¸­çš„ Node å’Œ Element ç±»å‹ã€‚

```ts
// è‡ªå®šä¹‰æ¸²æŸ“å™¨å¯ä»¥ä¼ å…¥ç‰¹å®šäºå¹³å°çš„ç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
import { createRenderer } from 'vue'
// HostNode ç±»å‹ï¼šNode,å®¿ä¸»ç¯å¢ƒä¸­çš„èŠ‚ç‚¹ã€‚
// HostElement ç±»å‹ï¼šElement,å®¿ä¸»ç¯å¢ƒä¸­çš„å…ƒç´ 
const { render, createApp } = createRenderer<Node, Element>({
  patchProp,
  ...nodeOps
})
```

***ï¼ ç»„ä»¶å‚è€ƒæ¥æºï¼š***

**main.jsä¸App.jsæ¥æºï¼šåšå®¢å›­**
**ä½œè€…ï¼šå‰ç«¯æ‚è´§**
**é“¾æ¥ï¼šhttps://www.cnblogs.com/kdcg/p/13844808.html**

> å¤§ä½¬ğŸ®ğŸºå•Šï¼ï¼ï¼ï¼
>
> âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿âœ¿


main.js
```js
/* createRenderer */
import { createRenderer } from 'vue'
import App from "./App";
const { createApp } = createRenderer({
  // åˆ›å»ºå…ƒç´ 
  createElement(tag, isSVG, is) {
    return {tag}
  },
  // æ’å…¥å…ƒç´ 
  insert(child, parent, anchor) {
    child.parent = parent
    if (!parent.childs) {
      parent.childs = []
    } else {
      parent.childs.push(child)
    }
    // å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ç”»å¸ƒï¼Œæ‰§è¡Œç»˜ç”»é€»è¾‘
    if (parent.nodeType === 1) {
      draw(child)
    }
  },
  // å…ƒç´ å±æ€§æ¯”è¾ƒ
  patchProp(el, key, prevValue, nextValue) {
    el[key] = nextValue
  }
  // è‡ªå·±å¹³å°å…¶å®ƒæ›´å¤šçš„æ“ä½œæ–¹æ³•
  // ...
})
const draw = (el, noClear) => {
  debugger
  if (!noClear) {
    ctx.clearRect(0, 0, canvas.width, canvas.height)
  }
  if (el.tag === 'bar-chart') {
    const { data } = el
    const barWidth = canvas.width / 10,
      gap = 20,
      paddingLeft = (data.length * barWidth + (data.length - 1) * gap) / 3,
      paddingBootom = 10;
    data.forEach(({ title, count, color }, index) => {
      const x = paddingLeft + index * (barWidth + gap)
      const y = canvas.height - paddingBootom - count
      ctx.fillStyle = color
      ctx.fillRect(x, y, barWidth, count)
    })
  }

  // é€’å½’
  el.childs && el.childs.forEach(child => draw(child, true))
}
let canvas, ctx;
function createCanvasApp(App) {
  const app = createApp(App)
  app.config.isCustomElement = tag => tag === 'bar-chart'
  const mount = app.mount
  // é‡å†™mountæ–¹æ³•ï¼Œæ‰§è¡Œåˆå§‹æ“ä½œ
  app.mount = function(selector) {
    canvas = document.createElement('canvas')
    canvas.width = window.innerWidth
    canvas.height = window.innerHeight
    document.querySelector(selector).appendChild(canvas)
    ctx = canvas.getContext('2d')
    mount(canvas)
  }
  // è¿”å›appï¼Œä»¥ä¾›é“¾å¼è°ƒç”¨åŠæ‘‡æ•°ä¼˜åŒ–
  return app
}
const app = createCanvasApp(App)
app.mount('#app')
```

App.vue
```html
<template #chart>
  <bar-chart :data="chartData" id="chart"></bar-chart>
</template>

<script>
export default {
  name: 'App',
  data() {
    return {
      chartData: [
        { title: 'é’é“œ', count: 200, color: 'red' },
        { title: 'ç™½é“¶', count: 150, color: 'yellow' },
        { title: 'é»„é‡‘', count: 100, color: 'gray' },
        { title: 'é’»çŸ³', count: 80, color: 'green' },
        { title: 'ç‹è€…', count: 50, color: 'gold' }
      ]
    }
  }
}
</script>

```

> æºç æœ‰ç‚¹é•¿ï¼Œå‡ åƒè¡Œï¼Œvueæ°´å¤ªæ·±ï¼ŒæŠŠæ¡ä¸ä½[baseCreateRendererå®ç°](https://github.com/vuejs/vue-next/blob/ef5c41523f98dbb9c26700fa3b987a2fae26b4e1/packages/runtime-core/src/renderer.ts#L436)

